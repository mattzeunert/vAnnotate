
<!doctype html>
<html>
    <head>
        <title>underscore.js | vAnnotate annotations</title>
        <meta charset="utf-8">
    </head>
    <body class="local-server">
        <style>
            body {
                margin: 0;
            }
            pre {
                font-family: Droid Sans;
            }
            
.highlight .hll { background-color: #333333 }
.highlight  {

background: #111111;

color: #ffffff ;

padding: 0.2em 0.9em;
  margin-bottom: 1em;
    font: normal normal normal 115%/normal 'Monaco', 'Courier New', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', monospace !important;
  line-height: 1.1em;
  overflow: auto;
    font-size: 1.0em;
    border: 1px solid #CCC;

    -moz-border-radius:7px;
    -webkit-border-radius:7px;
    border-radius:7px;


}

p > code, p > a > code, li > code, h3 > code
{

border-radius: 4px;
-webkit-border-radius: 4px;
-moz-border-radius: 4px;
color: #C5CBD0;
/*color: white*/
background-image: url(/images/opaque_20.png);
font-family: Menlo, Consolas, "Courier New", Courier, "Liberation Mono", monospace;
font-size: 1.1em;
/*height: 0px;
image-rendering: auto;
left: auto;
list-style-type: disc;*/
padding-bottom: 2px;
padding-left: 4px;
padding-right: 4px;
padding-top: 2px;
text-decoration: none;
text-indent: 0px;
text-shadow: none;
text-transform: none;
top: auto;

}


p > a > code
{
color: #95be7d;
}

code, pre {
    font-family: "Consolas", "Courier New", "Courier", "FreeMono", monospace;
    font-size:0.95em;
    margin: 1em 0 1.5em 0;
}

.highlight span
{
font-family: "Consolas", "Courier New", "Courier", "FreeMono", monospace;
font-size:1em;
}

.highlight .hll { background-color: #49483e }
.highlight  { /*background: #272822;*/ color: #f8f8f2 }
.highlight .c { color: #75715e } /* Comment */
.highlight .err { color: #960050; background-color: #1e0010 } /* Error */
.highlight .k { color: #66d9ef } /* Keyword */
.highlight .l { color: #ae81ff } /* Literal */
.highlight .n { color: #f8f8f2 } /* Name */
.highlight .o { color: #f92672 } /* Operator */
.highlight .p { color: #f8f8f2 } /* Punctuation */
.highlight .cm { color: #75715e } /* Comment.Multiline */
.highlight .cp { color: #75715e } /* Comment.Preproc */
.highlight .c1 { color: #75715e } /* Comment.Single */
.highlight .cs { color: #75715e } /* Comment.Special */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .kc { color: #66d9ef } /* Keyword.Constant */
.highlight .kd { color: #66d9ef } /* Keyword.Declaration */
.highlight .kn { color: #f92672 } /* Keyword.Namespace */
.highlight .kp { color: #66d9ef } /* Keyword.Pseudo */
.highlight .kr { color: #66d9ef } /* Keyword.Reserved */
.highlight .kt { color: #66d9ef } /* Keyword.Type */
.highlight .ld { color: #e6db74 } /* Literal.Date */
.highlight .m { color: #ae81ff } /* Literal.Number */
.highlight .s { color: #e6db74 } /* Literal.String */
.highlight .na { color: #a6e22e } /* Name.Attribute */
.highlight .nb { color: #f8f8f2 } /* Name.Builtin */
.highlight .nc { color: #a6e22e } /* Name.Class */
.highlight .no { color: #66d9ef } /* Name.Constant */
.highlight .nd { color: #a6e22e } /* Name.Decorator */
.highlight .ni { color: #f8f8f2 } /* Name.Entity */
.highlight .ne { color: #a6e22e } /* Name.Exception */
.highlight .nf { color: #a6e22e } /* Name.Function */
.highlight .nl { color: #f8f8f2 } /* Name.Label */
.highlight .nn { color: #f8f8f2 } /* Name.Namespace */
.highlight .nx { color: #a6e22e } /* Name.Other */
.highlight .py { color: #f8f8f2 } /* Name.Property */
.highlight .nt { color: #f92672 } /* Name.Tag */
.highlight .nv { color: #f8f8f2 } /* Name.Variable */
.highlight .ow { color: #f92672 } /* Operator.Word */
.highlight .w { color: #f8f8f2 } /* Text.Whitespace */
.highlight .mf { color: #ae81ff } /* Literal.Number.Float */
.highlight .mh { color: #ae81ff } /* Literal.Number.Hex */
.highlight .mi { color: #ae81ff } /* Literal.Number.Integer */
.highlight .mo { color: #ae81ff } /* Literal.Number.Oct */
.highlight .sb { color: #e6db74 } /* Literal.String.Backtick */
.highlight .sc { color: #e6db74 } /* Literal.String.Char */
.highlight .sd { color: #e6db74 } /* Literal.String.Doc */
.highlight .s2 { color: #e6db74 } /* Literal.String.Double */
.highlight .se { color: #ae81ff } /* Literal.String.Escape */
.highlight .sh { color: #e6db74 } /* Literal.String.Heredoc */
.highlight .si { color: #e6db74 } /* Literal.String.Interpol */
.highlight .sx { color: #e6db74 } /* Literal.String.Other */
.highlight .sr { color: #e6db74 } /* Literal.String.Regex */
.highlight .s1 { color: #e6db74 } /* Literal.String.Single */
.highlight .ss { color: #e6db74 } /* Literal.String.Symbol */
.highlight .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #f8f8f2 } /* Name.Variable.Class */
.highlight .vg { color: #f8f8f2 } /* Name.Variable.Global */
.highlight .vi { color: #f8f8f2 } /* Name.Variable.Instance */
.highlight .il { color: #ae81ff } /* Literal.Number.Integer.Long */

        </style>
        <link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'>

        <pre><div class="highlight"><pre><span class="c1">//     Underscore.js 1.6.0</span>
<span class="c1">//     http://underscorejs.org</span>
<span class="c1">//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters &amp; Editors</span>
<span class="c1">//     Underscore may be freely distributed under the MIT license.</span>

<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// Baseline setup</span>
  <span class="c1">// --------------</span>

  <span class="c1">// Establish the root object, `window` in the browser, or `exports` on the server.</span>
  <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

  <span class="c1">// Save the previous value of the `_` variable.</span>
  <span class="kd">var</span> <span class="nx">previousUnderscore</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">_</span><span class="p">;</span>

  <span class="c1">// Establish the object that gets returned to break out of a loop iteration.</span>
  <span class="kd">var</span> <span class="nx">breaker</span> <span class="o">=</span> <span class="p">{};</span>

  <span class="c1">// Save bytes in the minified (but not gzipped) version:</span>
  <span class="kd">var</span> <span class="nx">ArrayProto</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">ObjProto</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">FuncProto</span> <span class="o">=</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>

  <span class="c1">// Create quick reference variables for speed access to core prototypes.</span>
  <span class="kd">var</span>
    <span class="nx">push</span>             <span class="o">=</span> <span class="nx">ArrayProto</span><span class="p">.</span><span class="nx">push</span><span class="p">,</span>
    <span class="nx">slice</span>            <span class="o">=</span> <span class="nx">ArrayProto</span><span class="p">.</span><span class="nx">slice</span><span class="p">,</span>
    <span class="nx">concat</span>           <span class="o">=</span> <span class="nx">ArrayProto</span><span class="p">.</span><span class="nx">concat</span><span class="p">,</span>
    <span class="nx">toString</span>         <span class="o">=</span> <span class="nx">ObjProto</span><span class="p">.</span><span class="nx">toString</span><span class="p">,</span>
    <span class="nx">hasOwnProperty</span>   <span class="o">=</span> <span class="nx">ObjProto</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">;</span>

  <span class="c1">// All **ECMAScript 5** native function implementations that we hope to use</span>
  <span class="c1">// are declared here.</span>
  <span class="kd">var</span>
    <span class="nx">nativeIsArray</span>      <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">,</span>
    <span class="nx">nativeKeys</span>         <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">,</span>
    <span class="nx">nativeBind</span>         <span class="o">=</span> <span class="nx">FuncProto</span><span class="p">.</span><span class="nx">bind</span><span class="p">;</span>

  <span class="c1">// Create a safe reference to the Underscore object for use below.</span>
  <span class="kd">var</span> <span class="nx">_</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="k">instanceof</span> <span class="nx">_</span><span class="p">)</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="k">this</span> <span class="k">instanceof</span> <span class="nx">_</span><span class="p">))</span> <span class="k">return</span> <span class="k">new</span> <span class="nx">_</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_wrapped</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Export the Underscore object for **Node.js**, with</span>
  <span class="c1">// backwards-compatibility for the old `require()` API. If we&#39;re in</span>
  <span class="c1">// the browser, add `_` as a global object via a string identifier,</span>
  <span class="c1">// for Closure Compiler &quot;advanced&quot; mode.</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exports</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">exports</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">_</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">exports</span><span class="p">.</span><span class="nx">_</span> <span class="o">=</span> <span class="nx">_</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">_</span> <span class="o">=</span> <span class="nx">_</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Current version.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">VERSION</span> <span class="o">=</span> <span class="s1">&#39;1.6.0&#39;</span><span class="p">;</span>

  <span class="c1">// Collection Functions</span>
  <span class="c1">// --------------------</span>

  <span class="c1">// The cornerstone, an `each` implementation, aka `forEach`.</span>
  <span class="c1">// Handles raw objects in addition to array-likes. Treats all</span>
  <span class="c1">// sparse array-likes as if they were dense.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">forEach</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="o">+</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="nx">breaker</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]],</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">obj</span><span class="p">)</span> <span class="o">===</span> <span class="nx">breaker</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return the results of applying the iterator to each element.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">map</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">collect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">));</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">reduceError</span> <span class="o">=</span> <span class="s1">&#39;Reduce of empty array with no initial value&#39;</span><span class="p">;</span>

  <span class="c1">// **Reduce** builds up a single result from a list of values, aka `inject`,</span>
  <span class="c1">// or `foldl`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">reduce</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">foldl</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">inject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">memo</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">initial</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">initial</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">memo</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="nx">initial</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">memo</span> <span class="o">=</span> <span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">memo</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">initial</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="nx">reduceError</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">memo</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// The right-associative version of reduce, also known as `foldr`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">reduceRight</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">foldr</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">memo</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">initial</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">length</span> <span class="o">!==</span> <span class="o">+</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
      <span class="nx">length</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">index</span> <span class="o">=</span> <span class="nx">keys</span> <span class="o">?</span> <span class="nx">keys</span><span class="p">[</span><span class="o">--</span><span class="nx">length</span><span class="p">]</span> <span class="o">:</span> <span class="o">--</span><span class="nx">length</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">initial</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">memo</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
        <span class="nx">initial</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">memo</span> <span class="o">=</span> <span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">memo</span><span class="p">,</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">initial</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="nx">reduceError</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">memo</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return the first value which passes a truth test. Aliased as `detect`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">find</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">detect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span><span class="p">;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">predicate</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return all the elements that pass a truth test.</span>
  <span class="c1">// Aliased as `select`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">select</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">predicate</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">))</span> <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return all the elements for which a truth test fails.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">reject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">negate</span><span class="p">(</span><span class="nx">predicate</span><span class="p">),</span> <span class="nx">context</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Determine whether all of the elements match a truth test.</span>
  <span class="c1">// Aliased as `all`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">every</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">all</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">predicate</span> <span class="o">||</span> <span class="p">(</span><span class="nx">predicate</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">result</span> <span class="o">&amp;&amp;</span> <span class="nx">predicate</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)))</span> <span class="k">return</span> <span class="nx">breaker</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="o">!!</span><span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Determine if at least one element in the object matches a truth test.</span>
  <span class="c1">// Aliased as `any`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">some</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">any</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">predicate</span> <span class="o">||</span> <span class="p">(</span><span class="nx">predicate</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">||</span> <span class="p">(</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">predicate</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)))</span> <span class="k">return</span> <span class="nx">breaker</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="o">!!</span><span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Determine if the array or object contains a given value (using `===`).</span>
  <span class="c1">// Aliased as `include`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">include</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="o">+</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">value</span> <span class="o">===</span> <span class="nx">target</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="c1">// Invoke a method (with arguments) on every item in a collection.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">invoke</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">isFunc</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">method</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span><span class="nx">isFunc</span> <span class="o">?</span> <span class="nx">method</span> <span class="o">:</span> <span class="nx">value</span><span class="p">[</span><span class="nx">method</span><span class="p">]).</span><span class="nx">apply</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="c1">// Convenience version of a common use case of `map`: fetching a property.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">pluck</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="nx">key</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="c1">// Convenience version of a common use case of `filter`: selecting only objects</span>
  <span class="c1">// containing specific `key:value` pairs.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">where</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">attrs</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="c1">// Convenience version of a common use case of `find`: getting the first object</span>
  <span class="c1">// containing specific `key:value` pairs.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">findWhere</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">attrs</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="c1">// Return the maximum element or (element-based computation).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">,</span> <span class="nx">lastComputed</span> <span class="o">=</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">,</span>
        <span class="nx">value</span><span class="p">,</span> <span class="nx">computed</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">iterator</span> <span class="o">&amp;&amp;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&gt;</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">result</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">computed</span> <span class="o">=</span> <span class="nx">iterator</span> <span class="o">?</span> <span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="o">:</span> <span class="nx">value</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">computed</span> <span class="o">&gt;</span> <span class="nx">lastComputed</span> <span class="o">||</span> <span class="p">(</span><span class="nx">computed</span> <span class="o">===</span> <span class="o">-</span><span class="kc">Infinity</span> <span class="o">&amp;&amp;</span> <span class="nx">result</span> <span class="o">===</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">result</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
          <span class="nx">lastComputed</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return the minimum element (or element-based computation).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">min</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="kc">Infinity</span><span class="p">,</span> <span class="nx">lastComputed</span> <span class="o">=</span> <span class="kc">Infinity</span><span class="p">,</span>
        <span class="nx">value</span><span class="p">,</span> <span class="nx">computed</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">iterator</span> <span class="o">&amp;&amp;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&lt;</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">result</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">computed</span> <span class="o">=</span> <span class="nx">iterator</span> <span class="o">?</span> <span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="o">:</span> <span class="nx">value</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">computed</span> <span class="o">&lt;</span> <span class="nx">lastComputed</span> <span class="o">||</span> <span class="p">(</span><span class="nx">computed</span> <span class="o">===</span> <span class="kc">Infinity</span> <span class="o">&amp;&amp;</span> <span class="nx">result</span> <span class="o">===</span> <span class="kc">Infinity</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">result</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
          <span class="nx">lastComputed</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Shuffle an array, using the modern version of the</span>
  <span class="c1">// [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher–Yates_shuffle).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">shuffle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">rand</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">shuffled</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rand</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="nx">index</span><span class="o">++</span><span class="p">);</span>
      <span class="nx">shuffled</span><span class="p">[</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">shuffled</span><span class="p">[</span><span class="nx">rand</span><span class="p">];</span>
      <span class="nx">shuffled</span><span class="p">[</span><span class="nx">rand</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">shuffled</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Sample **n** random values from a collection.</span>
  <span class="c1">// If **n** is not specified, returns a single random element.</span>
  <span class="c1">// The internal `guard` argument allows it to work with `map`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">sample</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">guard</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">guard</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="o">+</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">_</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">shuffle</span><span class="p">(</span><span class="nx">obj</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">n</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="c1">// An internal function to generate lookup iterators.</span>
  <span class="kd">var</span> <span class="nx">lookupIterator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">context</span><span class="p">)</span> <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">value</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Sort the object&#39;s values by a criterion produced by an iterator.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">sortBy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">iterator</span> <span class="o">=</span> <span class="nx">lookupIterator</span><span class="p">(</span><span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">value</span><span class="o">:</span> <span class="nx">value</span><span class="p">,</span>
        <span class="nx">index</span><span class="o">:</span> <span class="nx">index</span><span class="p">,</span>
        <span class="nx">criteria</span><span class="o">:</span> <span class="nx">iterator</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span>
      <span class="p">};</span>
    <span class="p">}).</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">left</span><span class="p">,</span> <span class="nx">right</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">left</span><span class="p">.</span><span class="nx">criteria</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">right</span><span class="p">.</span><span class="nx">criteria</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">!==</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&gt;</span> <span class="nx">b</span> <span class="o">||</span> <span class="nx">a</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&lt;</span> <span class="nx">b</span> <span class="o">||</span> <span class="nx">b</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">left</span><span class="p">.</span><span class="nx">index</span> <span class="o">-</span> <span class="nx">right</span><span class="p">.</span><span class="nx">index</span><span class="p">;</span>
    <span class="p">}),</span> <span class="s1">&#39;value&#39;</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// An internal function used for aggregate &quot;group by&quot; operations.</span>
  <span class="kd">var</span> <span class="nx">group</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">behavior</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="nx">iterator</span> <span class="o">=</span> <span class="nx">lookupIterator</span><span class="p">(</span><span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">iterator</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">obj</span><span class="p">);</span>
        <span class="nx">behavior</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Groups the object&#39;s values by a criterion. Pass either a string attribute</span>
  <span class="c1">// to group by, or a function that returns the criterion.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">groupBy</span> <span class="o">=</span> <span class="nx">group</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="o">?</span> <span class="nx">result</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">value</span><span class="p">];</span>
  <span class="p">});</span>

  <span class="c1">// Indexes the object&#39;s values by a criterion, similar to `groupBy`, but for</span>
  <span class="c1">// when you know that your index values will be unique.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">indexBy</span> <span class="o">=</span> <span class="nx">group</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="c1">// Counts instances of an object that group by a certain criterion. Pass</span>
  <span class="c1">// either a string attribute to count by, or a function that returns the</span>
  <span class="c1">// criterion.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">countBy</span> <span class="o">=</span> <span class="nx">group</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="o">?</span> <span class="nx">result</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="o">++</span> <span class="o">:</span> <span class="nx">result</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="c1">// Use a comparator function to figure out the smallest index at which</span>
  <span class="c1">// an object should be inserted so as to maintain order. Uses binary search.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">sortedIndex</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">iterator</span> <span class="o">=</span> <span class="nx">lookupIterator</span><span class="p">(</span><span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">iterator</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">high</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">low</span> <span class="o">&lt;</span> <span class="nx">high</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">mid</span> <span class="o">=</span> <span class="p">(</span><span class="nx">low</span> <span class="o">+</span> <span class="nx">high</span><span class="p">)</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
      <span class="nx">iterator</span><span class="p">(</span><span class="nx">array</span><span class="p">[</span><span class="nx">mid</span><span class="p">])</span> <span class="o">&lt;</span> <span class="nx">value</span> <span class="o">?</span> <span class="nx">low</span> <span class="o">=</span> <span class="nx">mid</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">:</span> <span class="nx">high</span> <span class="o">=</span> <span class="nx">mid</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">low</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Safely create a real, live array from anything iterable.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">toArray</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">obj</span><span class="p">)</span> <span class="k">return</span> <span class="p">[];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="k">return</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="o">+</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Return the number of elements in an object.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">size</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="o">+</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">?</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Array Functions</span>
  <span class="c1">// ---------------</span>

  <span class="c1">// Get the first element of an array. Passing **n** will return the first N</span>
  <span class="c1">// values in the array. Aliased as `head` and `take`. The **guard** check</span>
  <span class="c1">// allows it to work with `_.map`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">first</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">head</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">take</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">guard</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">array</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">((</span><span class="nx">n</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="nx">guard</span><span class="p">)</span> <span class="k">return</span> <span class="nx">array</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="p">[];</span>
    <span class="k">return</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">n</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Returns everything but the last entry of the array. Especially useful on</span>
  <span class="c1">// the arguments object. Passing **n** will return all the values in</span>
  <span class="c1">// the array, excluding the last N. The **guard** check allows it to work with</span>
  <span class="c1">// `_.map`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">initial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">guard</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="p">(</span><span class="nx">n</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">guard</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="nx">n</span><span class="p">)));</span>
  <span class="p">};</span>

  <span class="c1">// Get the last element of an array. Passing **n** will return the last N</span>
  <span class="c1">// values in the array. The **guard** check allows it to work with `_.map`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">last</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">guard</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">array</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">((</span><span class="nx">n</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="nx">guard</span><span class="p">)</span> <span class="k">return</span> <span class="nx">array</span><span class="p">[</span><span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
    <span class="k">return</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="c1">// Returns everything but the first entry of the array. Aliased as `tail` and `drop`.</span>
  <span class="c1">// Especially useful on the arguments object. Passing an **n** will return</span>
  <span class="c1">// the rest N values in the array. The **guard**</span>
  <span class="c1">// check allows it to work with `_.map`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">rest</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">tail</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">drop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">guard</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="p">(</span><span class="nx">n</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="nx">guard</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="nx">n</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Trim out all falsy values from an array.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">compact</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Internal implementation of a recursive `flatten` function.</span>
  <span class="kd">var</span> <span class="nx">flatten</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">shallow</span><span class="p">,</span> <span class="nx">strict</span><span class="p">,</span> <span class="nx">output</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">shallow</span> <span class="o">&amp;&amp;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">concat</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">input</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArguments</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">strict</span><span class="p">)</span> <span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">shallow</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">flatten</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">shallow</span><span class="p">,</span> <span class="nx">strict</span><span class="p">,</span> <span class="nx">output</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">output</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Flatten out an array, either recursively (by default), or just one level.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">flatten</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">shallow</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">flatten</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">shallow</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="p">[]);</span>
  <span class="p">};</span>

  <span class="c1">// Return a version of the array that does not contain the specified value(s).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">without</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">difference</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="c1">// Split an array into two arrays: one whose elements all satisfy the given</span>
  <span class="c1">// predicate, and one whose elements all do not satisfy the predicate.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">partition</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">predicate</span> <span class="o">=</span> <span class="nx">lookupIterator</span><span class="p">(</span><span class="nx">predicate</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">pass</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">fail</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="p">(</span><span class="nx">predicate</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="o">?</span> <span class="nx">pass</span> <span class="o">:</span> <span class="nx">fail</span><span class="p">).</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="p">[</span><span class="nx">pass</span><span class="p">,</span> <span class="nx">fail</span><span class="p">];</span>
  <span class="p">};</span>

  <span class="c1">// Produce a duplicate-free version of the array. If the array has already</span>
  <span class="c1">// been sorted, you have the option of using a faster algorithm.</span>
  <span class="c1">// Aliased as `unique`.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">uniq</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">unique</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">isSorted</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">array</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="p">[];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">isSorted</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">context</span> <span class="o">=</span> <span class="nx">iterator</span><span class="p">;</span>
      <span class="nx">iterator</span> <span class="o">=</span> <span class="nx">isSorted</span><span class="p">;</span>
      <span class="nx">isSorted</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">seen</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">iterator</span><span class="p">)</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">array</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">isSorted</span> <span class="o">?</span> <span class="p">(</span><span class="o">!</span><span class="nx">i</span> <span class="o">||</span> <span class="nx">seen</span> <span class="o">!==</span> <span class="nx">value</span><span class="p">)</span> <span class="o">:</span> <span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">seen</span><span class="p">,</span> <span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isSorted</span><span class="p">)</span> <span class="nx">seen</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="k">else</span> <span class="nx">seen</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Produce an array that contains the union: each distinct element from all of</span>
  <span class="c1">// the passed-in arrays.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">union</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">uniq</span><span class="p">(</span><span class="nx">flatten</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="p">[]));</span>
  <span class="p">};</span>

  <span class="c1">// Produce an array that contains every item shared between all the</span>
  <span class="c1">// passed-in arrays.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">intersection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">array</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">argsLength</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">item</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">argsLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span> <span class="nx">item</span><span class="p">))</span> <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">j</span> <span class="o">===</span> <span class="nx">argsLength</span><span class="p">)</span> <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Take the difference between one array and a number of other arrays.</span>
  <span class="c1">// Only the elements present in just the first array will remain.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">difference</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">rest</span> <span class="o">=</span> <span class="nx">flatten</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="p">[]);</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span> <span class="k">return</span> <span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">rest</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span> <span class="p">});</span>
  <span class="p">};</span>

  <span class="c1">// Zip together multiple lists into a single array -- elements that share</span>
  <span class="c1">// an index go together.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">zip</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
    <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">results</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">pluck</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="nx">i</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Converts lists into objects. Pass either a single array of `[key, value]`</span>
  <span class="c1">// pairs, or two parallel arrays of the same length -- one of keys, and one of</span>
  <span class="c1">// the corresponding values.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">object</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">values</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">list</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="p">{};</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">values</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">[</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">[</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return the position of the first occurrence of an item in an array,</span>
  <span class="c1">// or -1 if the item is not included in the array.</span>
  <span class="c1">// If the array is large and already in sort order, pass `true`</span>
  <span class="c1">// for **isSorted** to use binary search.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">indexOf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">isSorted</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">array</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isSorted</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">isSorted</span> <span class="o">==</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">i</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isSorted</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">+</span> <span class="nx">isSorted</span><span class="p">)</span> <span class="o">:</span> <span class="nx">isSorted</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">i</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">sortedIndex</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">item</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">item</span> <span class="o">?</span> <span class="nx">i</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">item</span><span class="p">)</span> <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="nx">_</span><span class="p">.</span><span class="nx">lastIndexOf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">from</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">array</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">from</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="o">:</span> <span class="nx">from</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">item</span><span class="p">)</span> <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Generate an integer Array containing an arithmetic progression. A port of</span>
  <span class="c1">// the native Python `range()` function. See</span>
  <span class="c1">// [the Python documentation](http://docs.python.org/library/functions.html#range).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">range</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">stop</span><span class="p">,</span> <span class="nx">step</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">stop</span> <span class="o">=</span> <span class="nx">start</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nx">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">step</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="nx">stop</span> <span class="o">-</span> <span class="nx">start</span><span class="p">)</span> <span class="o">/</span> <span class="nx">step</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">range</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>

    <span class="k">while</span><span class="p">(</span><span class="nx">idx</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">range</span><span class="p">[</span><span class="nx">idx</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nx">start</span><span class="p">;</span>
      <span class="nx">start</span> <span class="o">+=</span> <span class="nx">step</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">range</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Function (ahem) Functions</span>
  <span class="c1">// ------------------</span>

  <span class="c1">// Reusable constructor function for prototype setting.</span>
  <span class="kd">var</span> <span class="nx">ctor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){};</span>

  <span class="c1">// Create a function bound to a given object (assigning `this`, and arguments,</span>
  <span class="c1">// optionally). Delegates to **ECMAScript 5**&#39;s native `Function.bind` if</span>
  <span class="c1">// available.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">bound</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">nativeBind</span> <span class="o">&amp;&amp;</span> <span class="nx">func</span><span class="p">.</span><span class="nx">bind</span> <span class="o">===</span> <span class="nx">nativeBind</span><span class="p">)</span> <span class="k">return</span> <span class="nx">nativeBind</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">func</span><span class="p">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Bind must be called on a function&#39;</span><span class="p">);</span>
    <span class="nx">args</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">bound</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="k">this</span> <span class="k">instanceof</span> <span class="nx">bound</span><span class="p">))</span> <span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)));</span>
      <span class="nx">ctor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctor</span><span class="p">;</span>
      <span class="nx">ctor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">self</span><span class="p">,</span> <span class="nx">args</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)));</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">Object</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="o">===</span> <span class="nx">result</span><span class="p">)</span> <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">self</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Partially apply a function by creating a version that has had some of its</span>
  <span class="c1">// arguments pre-filled, without changing its dynamic `this` context. _ acts</span>
  <span class="c1">// as a placeholder, allowing any combination of arguments to be pre-filled.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">partial</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">boundArgs</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">boundArgs</span><span class="p">.</span><span class="nx">slice</span><span class="p">();</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">_</span><span class="p">)</span> <span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">position</span><span class="o">++</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="k">while</span> <span class="p">(</span><span class="nx">position</span> <span class="o">&lt;</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="nx">args</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="nx">position</span><span class="o">++</span><span class="p">]);</span>
      <span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Bind a number of an object&#39;s methods to that object. Remaining arguments</span>
  <span class="c1">// are the method names to be bound. Useful for ensuring that all callbacks</span>
  <span class="c1">// defined on an object belong to it.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">bindAll</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">funcs</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">funcs</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;bindAll must be passed function names&#39;</span><span class="p">);</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">funcs</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">f</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">f</span><span class="p">],</span> <span class="nx">obj</span><span class="p">);</span> <span class="p">});</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Memoize an expensive function by storing its results.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">memoize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">hasher</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hasher</span><span class="p">)</span> <span class="nx">hasher</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">memoize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">cache</span> <span class="o">=</span> <span class="nx">memoize</span><span class="p">.</span><span class="nx">cache</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">hasher</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">cache</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
    <span class="p">};</span>
    <span class="nx">memoize</span><span class="p">.</span><span class="nx">cache</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">return</span> <span class="nx">memoize</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Delays a function for the given number of milliseconds, and then calls</span>
  <span class="c1">// it with the arguments supplied.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">delay</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">wait</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span> <span class="p">},</span> <span class="nx">wait</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Defers a function, scheduling it to run after the current call stack has</span>
  <span class="c1">// cleared.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">defer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">delay</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="p">[</span><span class="nx">func</span><span class="p">,</span> <span class="mi">1</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">)));</span>
  <span class="p">};</span>

  <span class="c1">// Returns a function, that, when invoked, will only be triggered at most once</span>
  <span class="c1">// during a given window of time. Normally, the throttled function will run</span>
  <span class="c1">// as much as it can, without ever going more than once per `wait` duration;</span>
  <span class="c1">// but if you&#39;d like to disable the execution on the leading edge, pass</span>
  <span class="c1">// `{leading: false}`. To disable execution on the trailing edge, ditto.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">throttle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">wait</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">result</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">previous</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span>
    <span class="kd">var</span> <span class="nx">later</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">previous</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">leading</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      <span class="nx">timeout</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="nx">result</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">timeout</span><span class="p">)</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">args</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">previous</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">leading</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="nx">previous</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">remaining</span> <span class="o">=</span> <span class="nx">wait</span> <span class="o">-</span> <span class="p">(</span><span class="nx">now</span> <span class="o">-</span> <span class="nx">previous</span><span class="p">);</span>
      <span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
      <span class="nx">args</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">remaining</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">remaining</span> <span class="o">&gt;</span> <span class="nx">wait</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeout</span><span class="p">);</span>
        <span class="nx">timeout</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">previous</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">timeout</span><span class="p">)</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">args</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">timeout</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">trailing</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">timeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">later</span><span class="p">,</span> <span class="nx">remaining</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Returns a function, that, as long as it continues to be invoked, will not</span>
  <span class="c1">// be triggered. The function will be called after it stops being called for</span>
  <span class="c1">// N milliseconds. If `immediate` is passed, trigger the function on the</span>
  <span class="c1">// leading edge, instead of the trailing.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">debounce</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">wait</span><span class="p">,</span> <span class="nx">immediate</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">timeout</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">,</span> <span class="nx">result</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">later</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">last</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">timestamp</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">last</span> <span class="o">&lt;</span> <span class="nx">wait</span> <span class="o">&amp;&amp;</span> <span class="nx">last</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">timeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">later</span><span class="p">,</span> <span class="nx">wait</span> <span class="o">-</span> <span class="nx">last</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">timeout</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">immediate</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">result</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">timeout</span><span class="p">)</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">args</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
      <span class="nx">args</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">;</span>
      <span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">callNow</span> <span class="o">=</span> <span class="nx">immediate</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">timeout</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">timeout</span><span class="p">)</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">later</span><span class="p">,</span> <span class="nx">wait</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">callNow</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
        <span class="nx">context</span> <span class="o">=</span> <span class="nx">args</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Returns a function that will be executed at most one time, no matter how</span>
  <span class="c1">// often you call it. Useful for lazy initialization.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">once</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ran</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">memo</span><span class="p">;</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">ran</span><span class="p">)</span> <span class="k">return</span> <span class="nx">memo</span><span class="p">;</span>
      <span class="nx">ran</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="nx">memo</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
      <span class="nx">func</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">memo</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Returns the first function passed as an argument to the second,</span>
  <span class="c1">// allowing you to adjust arguments, run code before and after, and</span>
  <span class="c1">// conditionally execute the original function.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">wrap</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">wrapper</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">,</span> <span class="nx">func</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Returns a negated version of the passed-in predicate.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">negate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">predicate</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="o">!</span><span class="nx">predicate</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Returns a function that is the composition of a list of functions, each</span>
  <span class="c1">// consuming the return value of the function that follows.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">compose</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">funcs</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">;</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">funcs</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">args</span> <span class="o">=</span> <span class="p">[</span><span class="nx">funcs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">)];</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Returns a function that will only be executed after being called N times.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">after</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">times</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">--</span><span class="nx">times</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Object Functions</span>
  <span class="c1">// ----------------</span>

  <span class="c1">// Retrieve the names of an object&#39;s properties.</span>
  <span class="c1">// Delegates to **ECMAScript 5**&#39;s native `Object.keys`</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="k">return</span> <span class="p">[];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">nativeKeys</span><span class="p">)</span> <span class="k">return</span> <span class="nx">nativeKeys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">keys</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Retrieve the values of an object&#39;s properties.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">values</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">values</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Convert an object into a list of `[key, value]` pairs.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">pairs</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">pairs</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">pairs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]]];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">pairs</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Invert the keys and values of an object. The values must be serializable.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">invert</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">result</span><span class="p">[</span><span class="nx">obj</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]]]</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return a sorted list of the function names available on the object.</span>
  <span class="c1">// Aliased as `methods`</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">functions</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">methods</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">names</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span> <span class="nx">names</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">names</span><span class="p">.</span><span class="nx">sort</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="c1">// Extend a given object with all the properties in passed-in object(s).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">obj</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">source</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return a copy of the object only containing the whitelisted properties.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">pick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">iterator</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">obj</span><span class="p">))</span> <span class="nx">result</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nx">concat</span><span class="p">.</span><span class="nx">apply</span><span class="p">([],</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="nx">result</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

   <span class="c1">// Return a copy of the object without the blacklisted properties.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">omit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">keys</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">iterator</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">iterator</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">negate</span><span class="p">(</span><span class="nx">iterator</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">keys</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">concat</span><span class="p">.</span><span class="nx">apply</span><span class="p">([],</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="nb">String</span><span class="p">);</span>
      <span class="nx">iterator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">keys</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span> <span class="p">};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">pick</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Fill in a given object with default properties.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">defaults</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">source</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Create a (shallow-cloned) duplicate of an object.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">?</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">slice</span><span class="p">()</span> <span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">obj</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Invokes interceptor with the obj, and then returns obj.</span>
  <span class="c1">// The primary purpose of this method is to &quot;tap into&quot; a method chain, in</span>
  <span class="c1">// order to perform operations on intermediate results within the chain.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">tap</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">interceptor</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">interceptor</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Internal recursive comparison function for `isEqual`.</span>
  <span class="kd">var</span> <span class="nx">eq</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">aStack</span><span class="p">,</span> <span class="nx">bStack</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Identical objects are equal. `0 === -0`, but they aren&#39;t identical.</span>
    <span class="c1">// See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">===</span> <span class="nx">b</span><span class="p">)</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">||</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">b</span><span class="p">;</span>
    <span class="c1">// A strict comparison is necessary because `null == undefined`.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">b</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">===</span> <span class="nx">b</span><span class="p">;</span>
    <span class="c1">// Unwrap any wrapped objects.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="k">instanceof</span> <span class="nx">_</span><span class="p">)</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">_wrapped</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">b</span> <span class="k">instanceof</span> <span class="nx">_</span><span class="p">)</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">_wrapped</span><span class="p">;</span>
    <span class="c1">// Compare `[[Class]]` names.</span>
    <span class="kd">var</span> <span class="nx">className</span> <span class="o">=</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">className</span> <span class="o">!=</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">b</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Strings, numbers, dates, and booleans are compared by value.</span>
      <span class="k">case</span> <span class="s1">&#39;[object String]&#39;</span><span class="o">:</span>
        <span class="c1">// Primitives and their corresponding object wrappers are equivalent; thus, `&quot;5&quot;` is</span>
        <span class="c1">// equivalent to `new String(&quot;5&quot;)`.</span>
        <span class="k">return</span> <span class="nx">a</span> <span class="o">==</span> <span class="nb">String</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
      <span class="k">case</span> <span class="s1">&#39;[object Number]&#39;</span><span class="o">:</span>
        <span class="c1">// `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for</span>
        <span class="c1">// other numeric values.</span>
        <span class="k">return</span> <span class="nx">a</span> <span class="o">!=</span> <span class="o">+</span><span class="nx">a</span> <span class="o">?</span> <span class="nx">b</span> <span class="o">!=</span> <span class="o">+</span><span class="nx">b</span> <span class="o">:</span> <span class="p">(</span><span class="nx">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">b</span> <span class="o">:</span> <span class="nx">a</span> <span class="o">==</span> <span class="o">+</span><span class="nx">b</span><span class="p">);</span>
      <span class="k">case</span> <span class="s1">&#39;[object Date]&#39;</span><span class="o">:</span>
      <span class="k">case</span> <span class="s1">&#39;[object Boolean]&#39;</span><span class="o">:</span>
        <span class="c1">// Coerce dates and booleans to numeric primitive values. Dates are compared by their</span>
        <span class="c1">// millisecond representations. Note that invalid dates with millisecond representations</span>
        <span class="c1">// of `NaN` are not equivalent.</span>
        <span class="k">return</span> <span class="o">+</span><span class="nx">a</span> <span class="o">==</span> <span class="o">+</span><span class="nx">b</span><span class="p">;</span>
      <span class="c1">// RegExps are compared by their source patterns and flags.</span>
      <span class="k">case</span> <span class="s1">&#39;[object RegExp]&#39;</span><span class="o">:</span>
        <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">source</span> <span class="o">==</span> <span class="nx">b</span><span class="p">.</span><span class="nx">source</span> <span class="o">&amp;&amp;</span>
               <span class="nx">a</span><span class="p">.</span><span class="nx">global</span> <span class="o">==</span> <span class="nx">b</span><span class="p">.</span><span class="nx">global</span> <span class="o">&amp;&amp;</span>
               <span class="nx">a</span><span class="p">.</span><span class="nx">multiline</span> <span class="o">==</span> <span class="nx">b</span><span class="p">.</span><span class="nx">multiline</span> <span class="o">&amp;&amp;</span>
               <span class="nx">a</span><span class="p">.</span><span class="nx">ignoreCase</span> <span class="o">==</span> <span class="nx">b</span><span class="p">.</span><span class="nx">ignoreCase</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">!=</span> <span class="s1">&#39;object&#39;</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">b</span> <span class="o">!=</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="c1">// Assume equality for cyclic structures. The algorithm for detecting cyclic</span>
    <span class="c1">// structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">aStack</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">length</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Linear search. Performance is inversely proportional to the number of</span>
      <span class="c1">// unique nested structures.</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">aStack</span><span class="p">[</span><span class="nx">length</span><span class="p">]</span> <span class="o">==</span> <span class="nx">a</span><span class="p">)</span> <span class="k">return</span> <span class="nx">bStack</span><span class="p">[</span><span class="nx">length</span><span class="p">]</span> <span class="o">==</span> <span class="nx">b</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Objects with different constructors are not equivalent, but `Object`s</span>
    <span class="c1">// from different frames are.</span>
    <span class="kd">var</span> <span class="nx">aCtor</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">constructor</span><span class="p">,</span> <span class="nx">bCtor</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">constructor</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">aCtor</span> <span class="o">!==</span> <span class="nx">bCtor</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">aCtor</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">aCtor</span> <span class="k">instanceof</span> <span class="nx">aCtor</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                             <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">bCtor</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">bCtor</span> <span class="k">instanceof</span> <span class="nx">bCtor</span><span class="p">))</span>
                        <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s1">&#39;constructor&#39;</span> <span class="k">in</span> <span class="nx">a</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;constructor&#39;</span> <span class="k">in</span> <span class="nx">b</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Add the first object to the stack of traversed objects.</span>
    <span class="nx">aStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
    <span class="nx">bStack</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="c1">// Recursively compare objects and arrays.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">className</span> <span class="o">==</span> <span class="s1">&#39;[object Array]&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Compare array lengths to determine if a deep comparison is necessary.</span>
      <span class="nx">size</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="nx">result</span> <span class="o">=</span> <span class="nx">size</span> <span class="o">==</span> <span class="nx">b</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Deep compare the contents, ignoring non-numeric properties.</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">size</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">eq</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">size</span><span class="p">],</span> <span class="nx">b</span><span class="p">[</span><span class="nx">size</span><span class="p">],</span> <span class="nx">aStack</span><span class="p">,</span> <span class="nx">bStack</span><span class="p">)))</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// Deep compare objects.</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
          <span class="c1">// Count the expected number of properties.</span>
          <span class="nx">size</span><span class="o">++</span><span class="p">;</span>
          <span class="c1">// Deep compare each member.</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">eq</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="nx">b</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="nx">aStack</span><span class="p">,</span> <span class="nx">bStack</span><span class="p">)))</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="c1">// Ensure that both objects contain the same number of properties.</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">size</span><span class="o">--</span><span class="p">))</span> <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="o">!</span><span class="nx">size</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Remove the first object from the stack of traversed objects.</span>
    <span class="nx">aStack</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="nx">bStack</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Perform a deep comparison to check if two objects are equal.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">isEqual</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">eq</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[]);</span>
  <span class="p">};</span>

  <span class="c1">// Is a given array, string, or object empty?</span>
  <span class="c1">// An &quot;empty&quot; object has no enumerable own-properties.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">||</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">||</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArguments</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Is a given value a DOM element?</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">isElement</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Is a given value an array?</span>
  <span class="c1">// Delegates to ECMA5&#39;s native Array.isArray</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span> <span class="o">=</span> <span class="nx">nativeIsArray</span> <span class="o">||</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;[object Array]&#39;</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Is a given variable an object?</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obj</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s1">&#39;Arguments&#39;</span><span class="p">,</span> <span class="s1">&#39;Function&#39;</span><span class="p">,</span> <span class="s1">&#39;String&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;RegExp&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">[</span><span class="s1">&#39;is&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;[object &#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">});</span>

  <span class="c1">// Define a fallback version of the method in browsers (ahem, IE), where</span>
  <span class="c1">// there isn&#39;t any inspectable &quot;Arguments&quot; type.</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArguments</span><span class="p">(</span><span class="nx">arguments</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">isArguments</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;callee&#39;</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Optimize `isFunction` if appropriate.</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="p">(</span><span class="sr">/./</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">typeof</span> <span class="nx">obj</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Is a given object a finite number?</span>
  <span class="nx">_</span><span class="p">.</span><span class="nb">isFinite</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">isFinite</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">obj</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="c1">// Is the given value `NaN`? (NaN is the only number which does not equal itself).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nb">isNaN</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span> <span class="o">!=</span> <span class="o">+</span><span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Is a given value a boolean?</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">isBoolean</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obj</span> <span class="o">===</span> <span class="kc">true</span> <span class="o">||</span> <span class="nx">obj</span> <span class="o">===</span> <span class="kc">false</span> <span class="o">||</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;[object Boolean]&#39;</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Is a given value equal to null?</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">isNull</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obj</span> <span class="o">===</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Is a given variable undefined?</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">isUndefined</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obj</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Shortcut function for checking if an object has a given property directly</span>
  <span class="c1">// on itself (in other words, not on a prototype).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">has</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obj</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="c1">// Utility Functions</span>
  <span class="c1">// -----------------</span>

  <span class="c1">// Run Underscore.js in *noConflict* mode, returning the `_` variable to its</span>
  <span class="c1">// previous owner. Returns a reference to the Underscore object.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">noConflict</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">root</span><span class="p">.</span><span class="nx">_</span> <span class="o">=</span> <span class="nx">previousUnderscore</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Keep the identity function around for default iterators.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">identity</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="nx">_</span><span class="p">.</span><span class="nx">constant</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="nx">_</span><span class="p">.</span><span class="nx">noop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){};</span>

  <span class="nx">_</span><span class="p">.</span><span class="nx">property</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
    <span class="p">};</span>
  <span class="p">};</span>

  <span class="c1">// Returns a predicate for checking whether an object has a given set of `key:value` pairs.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">matches</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">attrs</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">===</span> <span class="nx">attrs</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">attrs</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="c1">// Run a function **n** times.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">times</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">accum</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">n</span><span class="p">));</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="nx">accum</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">iterator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">accum</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Return a random integer between min and max (inclusive).</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">random</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">max</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">max</span> <span class="o">=</span> <span class="nx">min</span><span class="p">;</span>
      <span class="nx">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">min</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">max</span> <span class="o">-</span> <span class="nx">min</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
  <span class="p">};</span>

  <span class="c1">// A (possibly faster) way to get the current timestamp as an integer.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">now</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span> <span class="o">||</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span> <span class="p">};</span>

  <span class="c1">// List of HTML entities for escaping.</span>
  <span class="kd">var</span> <span class="nx">entityMap</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">escape</span><span class="o">:</span> <span class="p">{</span>
      <span class="s1">&#39;&amp;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;amp;&#39;</span><span class="p">,</span>
      <span class="s1">&#39;&lt;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;lt;&#39;</span><span class="p">,</span>
      <span class="s1">&#39;&gt;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;gt;&#39;</span><span class="p">,</span>
      <span class="s1">&#39;&quot;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;quot;&#39;</span><span class="p">,</span>
      <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span> <span class="s1">&#39;&amp;#x27;&#39;</span>
    <span class="p">}</span>
  <span class="p">};</span>
  <span class="nx">entityMap</span><span class="p">.</span><span class="nx">unescape</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">invert</span><span class="p">(</span><span class="nx">entityMap</span><span class="p">.</span><span class="nx">escape</span><span class="p">);</span>

  <span class="c1">// Regexes containing the keys and values listed immediately above.</span>
  <span class="kd">var</span> <span class="nx">entityRegexes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">escape</span><span class="o">:</span>   <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">entityMap</span><span class="p">.</span><span class="nx">escape</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">),</span>
    <span class="nx">unescape</span><span class="o">:</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">entityMap</span><span class="p">.</span><span class="nx">unescape</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
  <span class="p">};</span>

  <span class="c1">// Functions for escaping and unescaping strings to/from HTML interpolation.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s1">&#39;escape&#39;</span><span class="p">,</span> <span class="s1">&#39;unescape&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">string</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
      <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="nx">string</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">entityRegexes</span><span class="p">[</span><span class="nx">method</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">entityMap</span><span class="p">[</span><span class="nx">method</span><span class="p">][</span><span class="nx">match</span><span class="p">];</span>
      <span class="p">});</span>
    <span class="p">};</span>
  <span class="p">});</span>

  <span class="c1">// If the value of the named `property` is a function then invoke it with the</span>
  <span class="c1">// `object` as context; otherwise, return it.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">result</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="nx">property</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">object</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">object</span><span class="p">[</span><span class="nx">property</span><span class="p">];</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">?</span> <span class="nx">object</span><span class="p">[</span><span class="nx">property</span><span class="p">]()</span> <span class="o">:</span> <span class="nx">value</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Add your own custom functions to the Underscore object.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">mixin</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">functions</span><span class="p">(</span><span class="nx">obj</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">func</span> <span class="o">=</span> <span class="nx">_</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">_wrapped</span><span class="p">];</span>
        <span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">args</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">args</span><span class="p">));</span>
      <span class="p">};</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="c1">// Generate a unique integer id (unique within the entire client session).</span>
  <span class="c1">// Useful for temporary DOM ids.</span>
  <span class="kd">var</span> <span class="nx">idCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">uniqueId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">prefix</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="o">++</span><span class="nx">idCounter</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">prefix</span> <span class="o">?</span> <span class="nx">prefix</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">:</span> <span class="nx">id</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// By default, Underscore uses ERB-style template delimiters, change the</span>
  <span class="c1">// following template settings to use alternative delimiters.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">templateSettings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">evaluate</span>    <span class="o">:</span> <span class="sr">/&lt;%([\s\S]+?)%&gt;/g</span><span class="p">,</span>
    <span class="nx">interpolate</span> <span class="o">:</span> <span class="sr">/&lt;%=([\s\S]+?)%&gt;/g</span><span class="p">,</span>
    <span class="nx">escape</span>      <span class="o">:</span> <span class="sr">/&lt;%-([\s\S]+?)%&gt;/g</span>
  <span class="p">};</span>

  <span class="c1">// When customizing `templateSettings`, if you don&#39;t want to define an</span>
  <span class="c1">// interpolation, evaluation or escaping regex, we need one that is</span>
  <span class="c1">// guaranteed not to match.</span>
  <span class="kd">var</span> <span class="nx">noMatch</span> <span class="o">=</span> <span class="sr">/(.)^/</span><span class="p">;</span>

  <span class="c1">// Certain characters need to be escaped so that they can be put into a</span>
  <span class="c1">// string literal.</span>
  <span class="kd">var</span> <span class="nx">escapes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span>      <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;\\&#39;</span><span class="o">:</span>     <span class="s1">&#39;\\&#39;</span><span class="p">,</span>
    <span class="s1">&#39;\r&#39;</span><span class="o">:</span>     <span class="s1">&#39;r&#39;</span><span class="p">,</span>
    <span class="s1">&#39;\n&#39;</span><span class="o">:</span>     <span class="s1">&#39;n&#39;</span><span class="p">,</span>
    <span class="s1">&#39;\u2028&#39;</span><span class="o">:</span> <span class="s1">&#39;u2028&#39;</span><span class="p">,</span>
    <span class="s1">&#39;\u2029&#39;</span><span class="o">:</span> <span class="s1">&#39;u2029&#39;</span>
  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">escaper</span> <span class="o">=</span> <span class="sr">/\\|&#39;|\r|\n|\u2028|\u2029/g</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">escapeChar</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;\\&#39;</span> <span class="o">+</span> <span class="nx">escapes</span><span class="p">[</span><span class="nx">match</span><span class="p">];</span>
  <span class="p">};</span>

  <span class="c1">// JavaScript micro-templating, similar to John Resig&#39;s implementation.</span>
  <span class="c1">// Underscore templating handles arbitrary delimiters, preserves whitespace,</span>
  <span class="c1">// and correctly escapes quotes within interpolated code.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">template</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">settings</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({},</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">templateSettings</span><span class="p">);</span>

    <span class="c1">// Combine delimiters into one regular expression via alternation.</span>
    <span class="kd">var</span> <span class="nx">matcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">([</span>
      <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">escape</span> <span class="o">||</span> <span class="nx">noMatch</span><span class="p">).</span><span class="nx">source</span><span class="p">,</span>
      <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">interpolate</span> <span class="o">||</span> <span class="nx">noMatch</span><span class="p">).</span><span class="nx">source</span><span class="p">,</span>
      <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">evaluate</span> <span class="o">||</span> <span class="nx">noMatch</span><span class="p">).</span><span class="nx">source</span>
    <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;|{{code}}#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">);</span>

    <span class="c1">// Compile the template source, escaping string literals appropriately.</span>
    <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="s2">&quot;__p+=&#39;&quot;</span><span class="p">;</span>
    <span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">matcher</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">escape</span><span class="p">,</span> <span class="nx">interpolate</span><span class="p">,</span> <span class="nx">evaluate</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">source</span> <span class="o">+=</span> <span class="nx">text</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">offset</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">escaper</span><span class="p">,</span> <span class="nx">escapeChar</span><span class="p">);</span>
      <span class="nx">index</span> <span class="o">=</span> <span class="nx">offset</span> <span class="o">+</span> <span class="nx">match</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">escape</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">source</span> <span class="o">+=</span> <span class="s2">&quot;&#39;+\n((__t=(&quot;</span> <span class="o">+</span> <span class="nx">escape</span> <span class="o">+</span> <span class="s2">&quot;))==null?&#39;&#39;:_.escape(__t))+\n&#39;&quot;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">interpolate</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">source</span> <span class="o">+=</span> <span class="s2">&quot;&#39;+\n((__t=(&quot;</span> <span class="o">+</span> <span class="nx">interpolate</span> <span class="o">+</span> <span class="s2">&quot;))==null?&#39;&#39;:__t)+\n&#39;&quot;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">evaluate</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">source</span> <span class="o">+=</span> <span class="s2">&quot;&#39;;\n&quot;</span> <span class="o">+</span> <span class="nx">evaluate</span> <span class="o">+</span> <span class="s2">&quot;\n__p+=&#39;&quot;</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="c1">// Adobe VMs need the match returned to produce the correct offest.</span>
      <span class="k">return</span> <span class="nx">match</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="nx">source</span> <span class="o">+=</span> <span class="s2">&quot;&#39;;\n&quot;</span><span class="p">;</span>

    <span class="c1">// If a variable is not specified, place data values in local scope.</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">settings</span><span class="p">.</span><span class="nx">variable</span><span class="p">)</span> <span class="nx">source</span> <span class="o">=</span> <span class="s1">&#39;with(obj||{}){\n&#39;</span> <span class="o">+</span> <span class="nx">source</span> <span class="o">+</span> <span class="s1">&#39;}\n&#39;</span><span class="p">;</span>

    <span class="nx">source</span> <span class="o">=</span> <span class="s2">&quot;var __t,__p=&#39;&#39;,__j=Array.prototype.join,&quot;</span> <span class="o">+</span>
      <span class="s2">&quot;print=function(){__p+=__j.call(arguments,&#39;&#39;);};\n&quot;</span> <span class="o">+</span>
      <span class="nx">source</span> <span class="o">+</span> <span class="s2">&quot;return __p;\n&quot;</span><span class="p">;</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">render</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">variable</span> <span class="o">||</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="nx">source</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">source</span> <span class="o">=</span> <span class="nx">source</span><span class="p">;</span>
      <span class="k">throw</span> <span class="nx">e</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="k">return</span> <span class="nx">render</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">_</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">render</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="c1">// Provide the compiled source as a convenience for precompilation.</span>
    <span class="kd">var</span> <span class="nx">argument</span> <span class="o">=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">variable</span> <span class="o">||</span> <span class="s1">&#39;obj&#39;</span><span class="p">;</span>
    <span class="nx">template</span><span class="p">.</span><span class="nx">source</span> <span class="o">=</span> <span class="s1">&#39;function(&#39;</span> <span class="o">+</span> <span class="nx">argument</span> <span class="o">+</span> <span class="s1">&#39;){\n&#39;</span> <span class="o">+</span> <span class="nx">source</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">template</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Add a &quot;chain&quot; function, which will delegate to the wrapper.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">chain</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_</span><span class="p">(</span><span class="nx">obj</span><span class="p">).</span><span class="nx">chain</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="c1">// OOP</span>
  <span class="c1">// ---------------</span>
  <span class="c1">// If Underscore is called as a function, it returns a wrapped object that</span>
  <span class="c1">// can be used OO-style. This wrapper holds altered versions of all the</span>
  <span class="c1">// underscore functions. Wrapped objects may be chained.</span>

  <span class="c1">// Helper function to continue chaining intermediate results.</span>
  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_chain</span> <span class="o">?</span> <span class="nx">_</span><span class="p">(</span><span class="nx">obj</span><span class="p">).</span><span class="nx">chain</span><span class="p">()</span> <span class="o">:</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="c1">// Add all of the Underscore functions to the wrapper object.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">mixin</span><span class="p">(</span><span class="nx">_</span><span class="p">);</span>

  <span class="c1">// Add all mutator Array functions to the wrapper.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s1">&#39;pop&#39;</span><span class="p">,</span> <span class="s1">&#39;push&#39;</span><span class="p">,</span> <span class="s1">&#39;reverse&#39;</span><span class="p">,</span> <span class="s1">&#39;shift&#39;</span><span class="p">,</span> <span class="s1">&#39;sort&#39;</span><span class="p">,</span> <span class="s1">&#39;splice&#39;</span><span class="p">,</span> <span class="s1">&#39;unshift&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">ArrayProto</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_wrapped</span><span class="p">;</span>
      <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">((</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;shift&#39;</span> <span class="o">||</span> <span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;splice&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="k">delete</span> <span class="nx">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">obj</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">});</span>

  <span class="c1">// Add all accessor Array functions to the wrapper.</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="s1">&#39;concat&#39;</span><span class="p">,</span> <span class="s1">&#39;join&#39;</span><span class="p">,</span> <span class="s1">&#39;slice&#39;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">ArrayProto</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_wrapped</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">));</span>
    <span class="p">};</span>
  <span class="p">});</span>

  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span>

    <span class="c1">// Start chaining a wrapped Underscore object.</span>
    <span class="nx">chain</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_chain</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="c1">// Extracts the result from a wrapped and chained object.</span>
    <span class="nx">value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_wrapped</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="p">});</span>

  <span class="c1">// AMD registration happens at the end for compatibility with AMD loaders</span>
  <span class="c1">// that may not enforce next-turn semantics on modules. Even though general</span>
  <span class="c1">// practice for AMD registration is to be anonymous, underscore registers</span>
  <span class="c1">// as a named module because, like jQuery, it is a base library that is</span>
  <span class="c1">// popular enough to be bundled in a third party lib, but not be part of</span>
  <span class="c1">// an AMD load request. Those cases could generate an error when an</span>
  <span class="c1">// anonymous define() is called outside of a loader request.</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">define</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">define</span><span class="p">(</span><span class="s1">&#39;underscore&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">_</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</pre></div>
<script>var vAnnotateResults = JSON.parse('{"results":{"0":"Object (76+ values, 24+ functions) \\\"[object Window]\\\"\\n{   external: [object Object]\\n    chrome: [object Object]\\n    document: [object HTMLDocument]\\n    serializeLogResult: function\\n    vAnnotate: [object Object]\\n(...)\\n}","1":"undefined","2":"Object \\\"[object Object]\\\"\\n{}","3":{"vaType":"list","items":[],"length":0},"4":"Object \\\"[object Object]\\\"\\n{}","5":"Function\\nfunction () {}","6":"Function\\nfunction push() { [native code] }","7":"Function\\nfunction slice() { [native code] }","8":"Function\\nfunction concat() { [native code] }","9":"Function\\nfunction toString() { [native code] }","10":"Function\\nfunction hasOwnProperty() { [native code] }","11":"Function\\nfunction isArray() { [native code] }","12":"Function\\nfunction keys() { [native code] }","13":"Function\\nfunction bind() { [native code] }","14":"Function\\nfunction (obj) {\\n if (obj instanceof _) {\\n var vAnnotateReturn_16f7815349fb8f6ec99efd5969b52f79 = obj;\\n return vAnnotateReturn_16f7815349fb8f6ec99efd5969b52f79;\\n }\\n if (!(this instanceof _)) {","15":{"vaType":"list","items":["1","2","3"],"length":3},"16":"Object (1+ values, 99+ functions) \\\"[object Object]\\\"\\n{   _wrapped: \\n    after: function\\n    all: function\\n    any: function\\n    bind: function\\n(...)\\n}","17":"Object (1+ values, 99+ functions) \\\"[object Object]\\\"\\n{   _wrapped: 1,2,3\\n    after: function\\n    all: function\\n    any: function\\n    bind: function\\n(...)\\n}","18":{"vaType":"list","items":["1","2","3"],"length":3},"22":"\\\"1.6.0\\\"","23":"Function\\nfunction (obj, iterator, context) {\\n if (obj == null) {\\n var vAnnotateReturn_6a53a437b6e28e494bae3fe940f098b5 = obj;\\n return vAnnotateReturn_6a53a437b6e28e494bae3fe940f098b5;\\n }\\n if (obj.length === +obj.length) {","25":"Array[6]\\n[Arguments,\\nFunction, \\nString, ...]","26":"Function\\nfunction (name) {\\n _[\'is\' + name] = function (obj) {\\n var vAnnotateReturn_088ffae98878b897c06daf9eded4e768 = toString.call(obj) == \'[object \' + name + \']\';\\n return vAnnotateReturn_088ffae98878b897c06daf9eded4e768;\\n };\\n }","27":"undefined","28":"null","29":"undefined","30":"Array[6]\\n[Arguments,\\nFunction, \\nString, ...]","31":"Function\\nfunction (obj, iterator, context) {\\n var results = [];\\n if (obj == null) {\\n var vAnnotateReturn_7337d0a8b7e20883ace1d1055db5fb47 = results;\\n return vAnnotateReturn_7337d0a8b7e20883ace1d1055db5fb47;\\n }","33":{"vaType":"list","items":["1","2","3"],"length":3},"34":"Function\\nfunction (num) {\\n var vAnnotateReturn_3d5ddda2987df0af6f25221db50a8fae = num * 2;\\n return vAnnotateReturn_3d5ddda2987df0af6f25221db50a8fae;\\n }","35":"undefined","36":{"vaType":"list","items":[],"length":0},"37":{"vaType":"list","items":[],"length":0},"38":"1","39":"0","40":{"vaType":"list","items":["1","2","3"],"length":3},"41":{"vaType":"list","items":["2","4","6"],"length":3},"42":"\\\"Reduce of empty array with no initial value\\\"","43":"Function\\nfunction (obj, iterator, memo, context) {\\n var initial = arguments.length &gt; 2;\\n if (obj == null) {\\n obj = [];\\n }\\n _.each(obj, function (value, index, list) {","46":{"vaType":"list","items":["1","2","3"],"length":3},"47":"Function\\nfunction (sum, num) {\\n var vAnnotateReturn_f281aa4aaa83452375f3336f9425d40c = sum + num;\\n return vAnnotateReturn_f281aa4aaa83452375f3336f9425d40c;\\n }","48":"0","49":"undefined","50":"true","51":{"vaType":"list","items":[],"length":0},"52":"1","53":"0","54":{"vaType":"list","items":["1","2","3"],"length":3},"55":"1","56":"true","57":"6","58":"Function\\nfunction (obj, iterator, memo, context) {\\n var initial = arguments.length &gt; 2;\\n if (obj == null) {\\n obj = [];\\n }\\n var length = obj.length;","60":{"vaType":"list","items":["\\\"foo\\\"","\\\"bar\\\"","\\\"baz\\\""],"length":3},"61":"Function\\nfunction (memo, str) {\\n var vAnnotateReturn_70b519fc314a70f2c18b4acc20e761d6 = memo + str;\\n return vAnnotateReturn_70b519fc314a70f2c18b4acc20e761d6;\\n }","62":"\\\"\\\"","63":"undefined","64":"true","65":{"vaType":"list","items":[],"length":0},"66":"3","67":{"vaType":"list","items":["\\\"a\\\"","\\\"b\\\"","\\\"c\\\""],"length":3},"68":"3","69":"\\\"foo\\\"","70":"0","71":{"vaType":"list","items":["\\\"foo\\\"","\\\"bar\\\"","\\\"baz\\\""],"length":3},"72":"2","73":"\\\"baz\\\"","74":"true","75":"\\\"bazbarfoo\\\"","76":"Function\\nfunction (obj, predicate, context) {\\n var result;\\n _.some(obj, function (value, index, list) {\\n if (predicate.call(context, value, index, list)) {\\n result = value;\\n var vAnnotateReturn_91ce30df21effc2438cdbb745378e122 = true;","78":{"vaType":"list","items":["1","2","3","4"],"length":4},"79":"Function\\nfunction (n) {\\n var vAnnotateReturn_ac07da1042339fe837e614d26d9d0d30 = n &gt; 2;\\n return vAnnotateReturn_ac07da1042339fe837e614d26d9d0d30;\\n }","80":"undefined","81":"undefined","82":"1","83":"0","84":{"vaType":"list","items":["1","2","3","4"],"length":4},"85":"3","86":"true","87":"3","88":"Function\\nfunction (obj, predicate, context) {\\n var results = [];\\n if (obj == null) {\\n var vAnnotateReturn_5bdfb7f5228c52c431b90a43c878f662 = results;\\n return vAnnotateReturn_5bdfb7f5228c52c431b90a43c878f662;\\n }","90":"Array[6]\\n[1,\\n2, \\n3, ...]","91":"Function\\nfunction (num) {\\n var vAnnotateReturn_fe996ac7918d35f69bbf34eae36561f4 = num % 2 == 0;\\n return vAnnotateReturn_fe996ac7918d35f69bbf34eae36561f4;\\n }","92":"undefined","93":{"vaType":"list","items":[],"length":0},"95":"1","96":"0","97":"Array[6]\\n[1,\\n2, \\n3, ...]","98":{"vaType":"list","items":["2","4","6"],"length":3},"99":"Function\\nfunction (obj, predicate, context) {\\n var vAnnotateReturn_8bee64bd1db55d7d61e2f4d44605b781 = _.filter(obj, _.negate(predicate), context);\\n return vAnnotateReturn_8bee64bd1db55d7d61e2f4d44605b781;\\n }","100":"Array[6]\\n[1,\\n2, \\n3, ...]","101":"Function\\nfunction (num) {\\n var vAnnotateReturn_495b7bf13bbc34e14f1dfb027c9f4b60 = num % 2 == 0;\\n return vAnnotateReturn_495b7bf13bbc34e14f1dfb027c9f4b60;\\n }","102":"undefined","103":{"vaType":"list","items":["1","3","5"],"length":3},"104":"Function\\nfunction (obj, predicate, context) {\\n predicate || (predicate = _.identity);\\n var result = true;\\n if (obj == null) {\\n var vAnnotateReturn_32b1608a453ecf330cf60eb5d3579d6d = result;\\n return vAnnotateReturn_32b1608a453ecf330cf60eb5d3579d6d;","106":{"vaType":"list","items":[],"length":0},"107":"Function\\nfunction (value) {\\n var vAnnotateReturn_849caf17aa5dd2217f0c18f767165652 = value;\\n return vAnnotateReturn_849caf17aa5dd2217f0c18f767165652;\\n }","108":"undefined","109":"true","111":"true","112":"0","113":{"vaType":"list","items":["true","true","true"],"length":3},"114":"Object \\\"[object Object]\\\"\\n{}","115":"true","116":"Function\\nfunction (obj, predicate, context) {\\n predicate || (predicate = _.identity);\\n var result = false;\\n if (obj == null) {\\n var vAnnotateReturn_6178c337067226b107d45fbdd35d5a4c = result;\\n return vAnnotateReturn_6178c337067226b107d45fbdd35d5a4c;","118":{"vaType":"list","items":["1","2","3","4"],"length":4},"119":"Function\\nfunction (value, index, list) {\\n if (predicate.call(context, value, index, list)) {\\n result = value;\\n var vAnnotateReturn_91ce30df21effc2438cdbb745378e122 = true;\\n return vAnnotateReturn_91ce30df21effc2438cdbb745378e122;\\n }","120":"undefined","121":"false","123":"1","124":"0","125":{"vaType":"list","items":["1","2","3","4"],"length":4},"126":"Object \\\"[object Object]\\\"\\n{}","127":"true","128":"Function\\nfunction (obj, target) {\\n if (obj == null) {\\n var vAnnotateReturn_b719c1227afbaefc3a1d169ae22969d5 = false;\\n return vAnnotateReturn_b719c1227afbaefc3a1d169ae22969d5;\\n }\\n if (obj.length === +obj.length) {","130":{"vaType":"list","items":["1","2","3"],"length":3},"131":"1","132":"false","133":"true","134":"true","135":"1","136":"false","137":"Function\\nfunction (obj, method) {\\n var args = slice.call(arguments, 2);\\n var isFunc = _.isFunction(method);\\n var vAnnotateReturn_4e523c1e1e70c4aa056bcc157083626f = _.map(obj, function (value) {\\n var vAnnotateReturn_c4a6fe68f6c9465b60ff7aedba85a4f7 = (isFunc ? method : value[method]).apply(value, args);\\n return vAnnotateReturn_c4a6fe68f6c9465b60ff7aedba85a4f7;","138":{"vaType":"list","items":[{"vaType":"list","items":["5","1","7"],"length":3},{"vaType":"list","items":["3","2","1"],"length":3}],"length":2},"139":"\\\"sort\\\"","140":{"vaType":"list","items":[],"length":0},"141":"false","142":{"vaType":"list","items":[{"vaType":"list","items":["1","5","7"],"length":3},{"vaType":"list","items":["1","2","3"],"length":3}],"length":2},"143":{"vaType":"list","items":["5","1","7"],"length":3},"144":{"vaType":"list","items":["1","5","7"],"length":3},"145":"Function\\nfunction (obj, key) {\\n var vAnnotateReturn_9f72dc5e9041fe8e5cb30cf2d57ded45 = _.map(obj, _.property(key));\\n return vAnnotateReturn_9f72dc5e9041fe8e5cb30cf2d57ded45;\\n }","146":{"vaType":"list","items":["{   name: moe\\n    age: 30\\n}","{   name: curly\\n    age: 50\\n}"],"length":2},"147":"\\\"name\\\"","148":{"vaType":"list","items":["\\\"moe\\\"","\\\"curly\\\""],"length":2},"149":"Function\\nfunction (obj, attrs) {\\n var vAnnotateReturn_0c6118f5baaed1a14c89928ac85adafc = _.filter(obj, _.matches(attrs));\\n return vAnnotateReturn_0c6118f5baaed1a14c89928ac85adafc;\\n }","150":{"vaType":"list","items":["{   a: 1\\n    b: 2\\n}","{   a: 2\\n    b: 2\\n}","{   a: 1\\n    b: 3\\n}","{   a: 1\\n    b: 4\\n}"],"length":4},"151":"Object (1 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n}","152":{"vaType":"list","items":["{   a: 1\\n    b: 2\\n}","{   a: 1\\n    b: 3\\n}","{   a: 1\\n    b: 4\\n}"],"length":3},"153":"Function\\nfunction (obj, attrs) {\\n var vAnnotateReturn_3766ee138d672dc195d5ac1cc54070d9 = _.find(obj, _.matches(attrs));\\n return vAnnotateReturn_3766ee138d672dc195d5ac1cc54070d9;\\n }","154":"Array[5]\\n[[object Object],\\n[object Object], \\n[object Object], ...]","155":"Object (1 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n}","156":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n    b: 2\\n}","157":"Function\\nfunction (obj, iterator, context) {\\n var result = -Infinity, lastComputed = -Infinity, value, computed;\\n if (!iterator && _.isArray(obj)) {\\n for (var i = 0, length = obj.length; i &lt; length; i++) {\\n value = obj[i];\\n if (value &gt; result) {","158":{"vaType":"list","items":["1","2","3"],"length":3},"159":"undefined","160":"undefined","161":"-Infinity","162":"-Infinity","163":"undefined","164":"undefined","165":"1","166":"1","167":"3","168":"Function\\nfunction (obj, iterator, context) {\\n var result = Infinity, lastComputed = Infinity, value, computed;\\n if (!iterator && _.isArray(obj)) {\\n for (var i = 0, length = obj.length; i &lt; length; i++) {\\n value = obj[i];\\n if (value &lt; result) {","169":{"vaType":"list","items":["1","2","3"],"length":3},"170":"undefined","171":"undefined","172":"Infinity","173":"Infinity","174":"undefined","175":"undefined","176":"1","177":"1","178":"1","179":"Function\\nfunction (obj) {\\n var rand;\\n var index = 0;\\n var shuffled = [];\\n _.each(obj, function (value) {\\n rand = _.random(index++);","189":"Function\\nfunction (obj, n, guard) {\\n if (n == null || guard) {\\n if (obj.length !== +obj.length) {\\n obj = _.values(obj);\\n }\\n var vAnnotateReturn_71dfec5776b5c0cb79e26026d5dc26fb = obj[_.random(obj.length - 1)];","196":"Function\\nfunction (value, context) {\\n if (value == null) {\\n var vAnnotateReturn_6473bd0de53802120ecc243a70fe0b1b = _.identity;\\n return vAnnotateReturn_6473bd0de53802120ecc243a70fe0b1b;\\n }\\n if (!_.isFunction(value)) {","197":"Function\\nfunction (person) {\\n var vAnnotateReturn_76ac35f54dec12406cf0742523de3d58 = person.age;\\n return vAnnotateReturn_76ac35f54dec12406cf0742523de3d58;\\n }","198":"undefined","199":"Function\\nfunction (value) {\\n var vAnnotateReturn_849caf17aa5dd2217f0c18f767165652 = value;\\n return vAnnotateReturn_849caf17aa5dd2217f0c18f767165652;\\n }","200":"Function\\nfunction (obj) {\\n var vAnnotateReturn_9a912735814c6171e820988ea0e08a38 = obj[key];\\n return vAnnotateReturn_9a912735814c6171e820988ea0e08a38;\\n }","201":"Function\\nfunction (person) {\\n var vAnnotateReturn_76ac35f54dec12406cf0742523de3d58 = person.age;\\n return vAnnotateReturn_76ac35f54dec12406cf0742523de3d58;\\n }","202":"Function\\nfunction () {\\n var vAnnotateReturn_46585c29e2f86fea50fd19800b488ff4 = value.apply(context, arguments);\\n return vAnnotateReturn_46585c29e2f86fea50fd19800b488ff4;\\n }","203":"undefined","204":"Function\\nfunction (obj, iterator, context) {\\n iterator = lookupIterator(iterator, context);\\n var vAnnotateReturn_95f2c1965bb4d49a8f66bc51384125bd = _.pluck(_.map(obj, function (value, index, list) {\\n var vAnnotateReturn_63b84d0f51e1c9e15b349fe2983383e6 = {\\n value: value,\\n index: index,","205":{"vaType":"list","items":["{   name: curly\\n    age: 50\\n}","{   name: moe\\n    age: 30\\n}"],"length":2},"206":"Function\\nfunction (person) {\\n var vAnnotateReturn_76ac35f54dec12406cf0742523de3d58 = person.age;\\n return vAnnotateReturn_76ac35f54dec12406cf0742523de3d58;\\n }","207":"undefined","208":"Function\\nfunction (person) {\\n var vAnnotateReturn_76ac35f54dec12406cf0742523de3d58 = person.age;\\n return vAnnotateReturn_76ac35f54dec12406cf0742523de3d58;\\n }","209":{"vaType":"list","items":["{   name: moe\\n    age: 30\\n}","{   name: curly\\n    age: 50\\n}"],"length":2},"210":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   value: [object Object]\\n    index: 0\\n    criteria: 50\\n}","211":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   value: [object Object]\\n    index: 1\\n    criteria: 30\\n}","212":"50","213":"30","214":"1","217":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   name: curly\\n    age: 50\\n}","218":"0","219":{"vaType":"list","items":["{   name: curly\\n    age: 50\\n}","{   name: moe\\n    age: 30\\n}"],"length":2},"220":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   value: [object Object]\\n    index: 0\\n    criteria: 50\\n}","221":"Function\\nfunction (behavior) {\\n var vAnnotateReturn_bab34f332d47f44ccd1c0d3d96a4961c = function (obj, iterator, context) {\\n var result = {};\\n iterator = lookupIterator(iterator, context);\\n _.each(obj, function (value, index) {\\n var key = iterator(value, index, obj);","222":"Function\\nfunction (result, value, key) {\\n _.has(result, key) ? result[key].push(value) : result[key] = [value];\\n }","223":"Function\\nfunction (obj, iterator, context) {\\n var result = {};\\n iterator = lookupIterator(iterator, context);\\n _.each(obj, function (value, index) {\\n var key = iterator(value, index, obj);\\n behavior(result, value, key);","224":"Array[6]\\n[1,\\n2, \\n3, ...]","225":"Function\\nfunction (num) {\\n var vAnnotateReturn_ab746504aee35354f6355fb20e388664 = num % 2;\\n return vAnnotateReturn_ab746504aee35354f6355fb20e388664;\\n }","226":"undefined","227":"Object \\\"[object Object]\\\"\\n{}","228":"Function\\nfunction (num) {\\n var vAnnotateReturn_ab746504aee35354f6355fb20e388664 = num % 2;\\n return vAnnotateReturn_ab746504aee35354f6355fb20e388664;\\n }","229":"1","230":"0","231":"1","232":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   0: 2,4,6\\n    1: 1,3,5\\n}","233":"Function\\nfunction (obj, iterator, context) {\\n var result = {};\\n iterator = lookupIterator(iterator, context);\\n _.each(obj, function (value, index) {\\n var key = iterator(value, index, obj);\\n behavior(result, value, key);","234":"Object \\\"[object Object]\\\"\\n{}","235":"1","236":"1","237":"Function\\nfunction (obj, iterator, context) {\\n var result = {};\\n iterator = lookupIterator(iterator, context);\\n _.each(obj, function (value, index) {\\n var key = iterator(value, index, obj);\\n behavior(result, value, key);","238":"Object \\\"[object Object]\\\"\\n{}","239":"1","240":"false","241":"1","242":"Function\\nfunction (obj, iterator, context) {\\n var result = {};\\n iterator = lookupIterator(iterator, context);\\n _.each(obj, function (value, index) {\\n var key = iterator(value, index, obj);\\n behavior(result, value, key);","243":"Object \\\"[object Object]\\\"\\n{}","244":"1","245":"false","246":"Function\\nfunction (array, obj, iterator, context) {\\n iterator = lookupIterator(iterator, context);\\n var value = iterator(obj);\\n var low = 0, high = array.length;\\n while (low &lt; high) {\\n var mid = low + high &gt;&gt;&gt; 1;","247":"Array[5]\\n[10,\\n20, \\n30, ...]","248":"35","249":"undefined","250":"undefined","251":"Function\\nfunction (value) {\\n var vAnnotateReturn_849caf17aa5dd2217f0c18f767165652 = value;\\n return vAnnotateReturn_849caf17aa5dd2217f0c18f767165652;\\n }","252":"35","253":"0","254":"5","255":"2","257":"3","258":"Function\\nfunction (obj) {\\n if (!obj) {\\n var vAnnotateReturn_cd663962ac9e6fad79d32963fc0e2d66 = [];\\n return vAnnotateReturn_cd663962ac9e6fad79d32963fc0e2d66;\\n }\\n if (_.isArray(obj)) {","259":"Object (4 values, 0 functions) \\\"[object Arguments]\\\"\\n{   0: [object Object]\\n    1: 2\\n    2: b\\n    3: [object Object]\\n}","261":{"vaType":"list","items":["1","2","3"],"length":3},"262":{"vaType":"list","items":["{}","2","\\\"b\\\"","{   a: 1\\n    b: 2\\n}"],"length":4},"263":{"vaType":"list","items":["1","2","3"],"length":3},"264":"Function\\nfunction (obj) {\\n if (obj == null) {\\n var vAnnotateReturn_726a3933a56478b442d8ea05fe89153f = 0;\\n return vAnnotateReturn_726a3933a56478b442d8ea05fe89153f;\\n }\\n var vAnnotateReturn_a119149608c6eebe8c0dfd4491bf1fbf = obj.length === +obj.length ? obj.length : _.keys(obj).length;","265":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   one: 1\\n    two: 2\\n    three: 3\\n}","266":"0","267":"3","268":"Function\\nfunction (array, n, guard) {\\n if (array == null) {\\n var vAnnotateReturn_062b71366ae6f1f92c663a66080b86cb = void 0;\\n return vAnnotateReturn_062b71366ae6f1f92c663a66080b86cb;\\n }\\n if (n == null || guard) {","271":{"vaType":"list","items":["1","2","3"],"length":3},"272":"undefined","273":"undefined","274":"undefined","275":"1","276":{"vaType":"list","items":[],"length":0},"277":{"vaType":"list","items":[],"length":0},"278":"Function\\nfunction (array, n, guard) {\\n var vAnnotateReturn_e4f3fa99c2baccddaa88aecc129216d3 = slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));\\n return vAnnotateReturn_e4f3fa99c2baccddaa88aecc129216d3;\\n }","279":"Array[5]\\n[1,\\n2, \\n3, ...]","280":"undefined","281":"undefined","282":{"vaType":"list","items":["1","2","3","4"],"length":4},"283":"Function\\nfunction (array, n, guard) {\\n if (array == null) {\\n var vAnnotateReturn_85c6a55b13e7e4c0cff9b1ec349f4745 = void 0;\\n return vAnnotateReturn_85c6a55b13e7e4c0cff9b1ec349f4745;\\n }\\n if (n == null || guard) {","284":{"vaType":"list","items":["1","2","3"],"length":3},"285":"undefined","286":"undefined","287":"undefined","288":"3","289":{"vaType":"list","items":[],"length":0},"290":"Function\\nfunction (array, n, guard) {\\n var vAnnotateReturn_489fd9da4ba62143b19a755206184e97 = slice.call(array, n == null || guard ? 1 : n);\\n return vAnnotateReturn_489fd9da4ba62143b19a755206184e97;\\n }","293":{"vaType":"list","items":["1","2","3","4"],"length":4},"294":"undefined","295":"undefined","296":{"vaType":"list","items":["2","3","4"],"length":3},"297":"Function\\nfunction (array) {\\n var vAnnotateReturn_108f4d11c7dc1dbb1f560322ad3b9236 = _.filter(array, _.identity);\\n return vAnnotateReturn_108f4d11c7dc1dbb1f560322ad3b9236;\\n }","298":"Array[6]\\n[0,\\n1, \\nfalse, ...]","299":{"vaType":"list","items":["1","2","3"],"length":3},"300":"Function\\nfunction (input, shallow, strict, output) {\\n if (shallow && _.every(input, _.isArray)) {\\n var vAnnotateReturn_c6dcc2c1aba3879ea91c77573fe80685 = concat.apply(output, input);\\n return vAnnotateReturn_c6dcc2c1aba3879ea91c77573fe80685;\\n }\\n for (var i = 0, length = input.length; i &lt; length; i++) {","301":{"vaType":"list","items":[{"vaType":"list","items":["2","3"],"length":2},{"vaType":"list","items":["2","3"],"length":2}],"length":2},"302":"undefined","303":"false","304":{"vaType":"list","items":[],"length":0},"305":{"vaType":"list","items":["1","2","3",{"vaType":"list","items":["4"],"length":1}],"length":4},"306":{"vaType":"list","items":["2","3"],"length":2},"307":{"vaType":"list","items":["2","3"],"length":2},"308":"Function\\nfunction (array, shallow) {\\n var vAnnotateReturn_8f6aaab1e58258d18ef2b06b374d019f = flatten(array, shallow, false, []);\\n return vAnnotateReturn_8f6aaab1e58258d18ef2b06b374d019f;\\n }","309":{"vaType":"list","items":[{"vaType":"list","items":["2","3"],"length":2},{"vaType":"list","items":["2","3"],"length":2}],"length":2},"310":"undefined","311":{"vaType":"list","items":["2","3","2","3"],"length":4},"312":"Function\\nfunction (array) {\\n var vAnnotateReturn_3b890b50ccc1c40a30a0daafde92cae5 = _.difference(array, slice.call(arguments, 1));\\n return vAnnotateReturn_3b890b50ccc1c40a30a0daafde92cae5;\\n }","313":"Array[7]\\n[1,\\n2, \\n1, ...]","314":{"vaType":"list","items":["2","3","4"],"length":3},"315":"Function\\nfunction (obj, predicate, context) {\\n predicate = lookupIterator(predicate, context);\\n var pass = [], fail = [];\\n _.each(obj, function (value, key, obj) {\\n (predicate(value, key, obj) ? pass : fail).push(value);\\n });","316":"Array[6]\\n[0,\\n1, \\n2, ...]","317":"Function\\nfunction (x) {\\n var vAnnotateReturn_4135b18a173c94a0a3241a5b61fc0988 = x &lt; 4;\\n return vAnnotateReturn_4135b18a173c94a0a3241a5b61fc0988;\\n }","318":"undefined","319":"Function\\nfunction (x) {\\n var vAnnotateReturn_4135b18a173c94a0a3241a5b61fc0988 = x &lt; 4;\\n return vAnnotateReturn_4135b18a173c94a0a3241a5b61fc0988;\\n }","320":{"vaType":"list","items":[],"length":0},"321":{"vaType":"list","items":[],"length":0},"322":"0","323":"0","324":"Array[6]\\n[0,\\n1, \\n2, ...]","325":{"vaType":"list","items":[{"vaType":"list","items":["0","1","2","3"],"length":4},{"vaType":"list","items":["4","5"],"length":2}],"length":2},"326":"Function\\nfunction (array, isSorted, iterator, context) {\\n if (array == null) {\\n var vAnnotateReturn_dcb2ad25c09de1187d4d2303ffc3416b = [];\\n return vAnnotateReturn_dcb2ad25c09de1187d4d2303ffc3416b;\\n }\\n if (_.isFunction(isSorted)) {","328":"Array[6]\\n[1,\\n2, \\n1, ...]","329":"undefined","330":"undefined","331":"undefined","332":{"vaType":"list","items":[],"length":0},"333":"undefined","334":"Function\\nfunction (value) {\\n var vAnnotateReturn_deb0dd00334395979efc616f636f2e80 = value.name;\\n return vAnnotateReturn_deb0dd00334395979efc616f636f2e80;\\n }","335":"false","336":{"vaType":"list","items":[],"length":0},"337":{"vaType":"list","items":[],"length":0},"338":"1","339":"\\\"moe\\\"","340":"1","341":{"vaType":"list","items":["1","2","3","4"],"length":4},"342":"Function\\nfunction () {\\n var vAnnotateReturn_69ff69d20165548322ac052830bacd57 = _.uniq(flatten(arguments, true, true, []));\\n return vAnnotateReturn_69ff69d20165548322ac052830bacd57;\\n }","343":"Array[5]\\n[1,\\n2, \\n3, ...]","344":"Function\\nfunction (array) {\\n if (array == null) {\\n var vAnnotateReturn_12c940dc0bb30ac2ae947e8d1e9d3847 = [];\\n return vAnnotateReturn_12c940dc0bb30ac2ae947e8d1e9d3847;\\n }\\n var result = [];","345":{"vaType":"list","items":["\\\"moe\\\"","\\\"curly\\\"","\\\"larry\\\""],"length":3},"346":{"vaType":"list","items":[],"length":0},"347":{"vaType":"list","items":[],"length":0},"348":"2","349":"\\\"moe\\\"","350":{"vaType":"list","items":["\\\"moe\\\""],"length":1},"351":"Function\\nfunction (array) {\\n var rest = flatten(slice.call(arguments, 1), true, true, []);\\n var vAnnotateReturn_4ab9dd845b4699053742f47517796f3f = _.filter(array, function (value) {\\n var vAnnotateReturn_0d87d89d052e095c2ef52dd91629c83b = !_.contains(rest, value);\\n return vAnnotateReturn_0d87d89d052e095c2ef52dd91629c83b;\\n });","352":"Array[7]\\n[1,\\n2, \\n1, ...]","353":{"vaType":"list","items":["0","1"],"length":2},"354":{"vaType":"list","items":["2","3","4"],"length":3},"355":"1","356":"false","357":"Function\\nfunction () {\\n var length = _.max(_.pluck(arguments, \'length\').concat(0));\\n var results = new Array(length);\\n for (var i = 0; i &lt; length; i++) {\\n results[i] = _.pluck(arguments, \'\' + i);\\n }","358":"3","359":{"vaType":"list","items":["undefined","undefined","undefined"],"length":3},"360":{"vaType":"list","items":["\\\"moe\\\"","30","true"],"length":3},"361":{"vaType":"list","items":[{"vaType":"list","items":["\\\"moe\\\"","30","true"],"length":3},{"vaType":"list","items":["\\\"larry\\\"","40","undefined"],"length":3},{"vaType":"list","items":["\\\"curly\\\"","50","undefined"],"length":3}],"length":3},"362":"Function\\nfunction (list, values) {\\n if (list == null) {\\n var vAnnotateReturn_7df7adacca8f533990385ef5f2f3f089 = {};\\n return vAnnotateReturn_7df7adacca8f533990385ef5f2f3f089;\\n }\\n var result = {};","363":{"vaType":"list","items":["\\\"moe\\\"","\\\"larry\\\"","\\\"curly\\\""],"length":3},"364":{"vaType":"list","items":["30","40","50"],"length":3},"365":"Object \\\"[object Object]\\\"\\n{}","366":"Object \\\"[object Object]\\\"\\n{}","367":"30","368":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   moe: 30\\n    larry: 40\\n    curly: 50\\n}","369":"Function\\nfunction (array, item, isSorted) {\\n if (array == null) {\\n var vAnnotateReturn_4d2020d3e1e2e423d72e48874f359aba = -1;\\n return vAnnotateReturn_4d2020d3e1e2e423d72e48874f359aba;\\n }\\n var i = 0, length = array.length;","370":{"vaType":"list","items":["1","2","3"],"length":3},"371":"1","372":"undefined","373":"-1","374":"0","375":"3","376":"5","378":"-1","379":"Function\\nfunction (array, item, from) {\\n if (array == null) {\\n var vAnnotateReturn_3f992ba4a9f79e23b3cc35293f15e7a6 = -1;\\n return vAnnotateReturn_3f992ba4a9f79e23b3cc35293f15e7a6;\\n }\\n var i = from == null ? array.length : from;","380":{"vaType":"list","items":["1","0","1"],"length":3},"381":"1","382":"undefined","383":"-1","384":"3","387":"Function\\nfunction (start, stop, step) {\\n if (arguments.length &lt;= 1) {\\n stop = start || 0;\\n start = 0;\\n }\\n step = arguments[2] || 1;","388":"1","389":"300000","390":"undefined","391":"10","392":"0","393":"1","394":"299999","395":"0","396":{"vaType":"list","items":[],"length":0},"397":"undefined","398":"1","399":{"vaType":"list","items":[],"length":0},"400":"Function\\nfunction () {\\n }","401":"Function\\nfunction (func, context) {\\n var args, bound;\\n if (nativeBind && func.bind === nativeBind) {\\n var vAnnotateReturn_0ff642f06784a5225d1630e2e6b88082 = nativeBind.apply(func, slice.call(arguments, 1));\\n return vAnnotateReturn_0ff642f06784a5225d1630e2e6b88082;\\n }","402":"Function\\nfunction (arg) {\\n var vAnnotateReturn_d2ce200286dbdce880c98924e8e61c8e = \'name: \' + (this.name || arg);\\n return vAnnotateReturn_d2ce200286dbdce880c98924e8e61c8e;\\n }","403":"Object (1 values, 0 functions) \\\"[object Object]\\\"\\n{   name: moe\\n}","404":"undefined","405":"undefined","406":"Function\\nfunction () { [native code] }","417":"Function\\nfunction (func) {\\n var boundArgs = slice.call(arguments, 1);\\n var vAnnotateReturn_b6b7c6912a926d5d77ac91fe5010ef0a = function () {\\n var position = 0;\\n var args = boundArgs.slice();\\n for (var i = 0, length = args.length; i &lt; length; i++) {","418":"Function\\nfunction () {\\n var vAnnotateReturn_776ea04d0ff1eba836929f9145511ab4 = this.name + \' \' + _.toArray(arguments).join(\' \');\\n return vAnnotateReturn_776ea04d0ff1eba836929f9145511ab4;\\n }","419":{"vaType":"list","items":["\\\"a\\\"","\\\"b\\\""],"length":2},"420":"Function\\nfunction () {\\n var position = 0;\\n var args = boundArgs.slice();\\n for (var i = 0, length = args.length; i &lt; length; i++) {\\n if (args[i] === _) {\\n args[i] = arguments[position++];","421":"0","422":{"vaType":"list","items":["\\\"a\\\"","\\\"b\\\""],"length":2},"423":"\\\"a\\\"","424":"\\\"moe a b c d\\\"","425":"Function\\nfunction (obj) {\\n var funcs = slice.call(arguments, 1);\\n if (funcs.length === 0) {\\n throw new Error(\'bindAll must be passed function names\');\\n }\\n _.each(funcs, function (f) {","426":"Object (1 values, 2 functions) \\\"[object Object]\\\"\\n{   name: moe\\n    getName: function\\n    sayHi: function\\n}","427":{"vaType":"list","items":["\\\"getName\\\"","\\\"sayHi\\\""],"length":2},"428":"\\\"getName\\\"","429":"Function\\nfunction () { [native code] }","430":"Object (1 values, 2 functions) \\\"[object Object]\\\"\\n{   name: moe\\n    getName: function\\n    sayHi: function\\n}","431":"Function\\nfunction (func, hasher) {\\n if (!hasher) {\\n hasher = _.identity;\\n }\\n var memoize = function () {\\n var cache = memoize.cache;","432":"Function\\nfunction (n) {\\n var vAnnotateReturn_34613542fcc5894c0c320f429db7d2d4 = n &lt; 2 ? n : fib(n - 1) + fib(n - 2);\\n return vAnnotateReturn_34613542fcc5894c0c320f429db7d2d4;\\n }","433":"undefined","434":"Function\\nfunction (value) {\\n var vAnnotateReturn_849caf17aa5dd2217f0c18f767165652 = value;\\n return vAnnotateReturn_849caf17aa5dd2217f0c18f767165652;\\n }","435":"Function\\nfunction () {\\n var cache = memoize.cache;\\n var key = hasher.apply(this, arguments);\\n if (!_.has(cache, key)) {\\n cache[key] = func.apply(this, arguments);\\n }","436":"Object \\\"[object Object]\\\"\\n{}","437":"10","438":"1","439":"1","440":"Object \\\"[object Object]\\\"\\n{}","441":"Function\\nfunction () {\\n var cache = memoize.cache;\\n var key = hasher.apply(this, arguments);\\n if (!_.has(cache, key)) {\\n cache[key] = func.apply(this, arguments);\\n }","442":"Function\\nfunction (func, wait) {\\n var args = slice.call(arguments, 2);\\n var vAnnotateReturn_7f7e78684fc3b8ea867d2a952f06e44b = setTimeout(function () {\\n var vAnnotateReturn_a729486cd465f5520faa7a8a679b0850 = func.apply(null, args);\\n return vAnnotateReturn_a729486cd465f5520faa7a8a679b0850;\\n }, wait);","443":"Function\\nfunction () {\\n delayed = true;\\n }","444":"100","445":{"vaType":"list","items":[],"length":0},"446":"28","447":"undefined","448":"Function\\nfunction (func) {\\n var vAnnotateReturn_8ee1ecf783705b5186f7a141350f12cf = _.delay.apply(_, [\\n func,\\n 1\\n ].concat(slice.call(arguments, 1)));\\n return vAnnotateReturn_8ee1ecf783705b5186f7a141350f12cf;","449":"Function\\nfunction (bool) {\\n deferred = bool;\\n }","450":"37","451":"Function\\nfunction (func, wait, options) {\\n var context, args, result;\\n var timeout = null;\\n var previous = 0;\\n options || (options = {});\\n var later = function () {","452":"Function\\nfunction () {\\n counter++;\\n }","453":"32","454":"undefined","455":"undefined","456":"undefined","457":"undefined","458":"null","459":"0","460":"Function\\nfunction () {\\n previous = options.leading === false ? 0 : _.now();\\n timeout = null;\\n result = func.apply(context, args);\\n if (!timeout) {\\n context = args = null;","461":"1454948452263","462":"null","463":"undefined","464":"null","466":"Function\\nfunction () {\\n var now = _.now();\\n if (!previous && options.leading === false) {\\n previous = now;\\n }\\n var remaining = wait - (now - previous);","467":"1454948452230","468":"1454948453165","469":"-1454948452198","470":"Object (75+ values, 25+ functions) \\\"[object Window]\\\"\\n{   external: [object Object]\\n    chrome: [object Object]\\n    document: [object HTMLDocument]\\n    serializeLogResult: function\\n    vAnnotate: [object Object]\\n(...)\\n}","471":"Object \\\"[object Arguments]\\\"\\n{}","472":"null","473":"1454948452230","474":"undefined","475":"null","477":"undefined","478":"Function\\nfunction (func, wait, immediate) {\\n var timeout, args, context, timestamp, result;\\n var later = function () {\\n var last = _.now() - timestamp;\\n if (last &lt; wait && last &gt; 0) {\\n timeout = setTimeout(later, wait - last);","479":"Function\\nfunction () {\\n counter++;\\n }","480":"32","481":"undefined","482":"undefined","483":"undefined","484":"undefined","485":"undefined","486":"undefined","487":"Function\\nfunction () {\\n var last = _.now() - timestamp;\\n if (last &lt; wait && last &gt; 0) {\\n timeout = setTimeout(later, wait - last);\\n } else {\\n timeout = null;","488":"17","489":"121","490":"Function\\nfunction () {\\n context = this;\\n args = arguments;\\n timestamp = _.now();\\n var callNow = immediate && !timeout;\\n if (!timeout) {","491":"Object (75+ values, 25+ functions) \\\"[object Window]\\\"\\n{   external: [object Object]\\n    chrome: [object Object]\\n    document: [object HTMLDocument]\\n    serializeLogResult: function\\n    vAnnotate: [object Object]\\n(...)\\n}","492":"Object \\\"[object Arguments]\\\"\\n{}","493":"1454948454776","494":"undefined","495":"118","496":"1","497":"null","499":"undefined","500":"Function\\nfunction (func) {\\n var ran = false, memo;\\n var vAnnotateReturn_633c23ac7735c096e53ff00df2a72fcc = function () {\\n if (ran) {\\n var vAnnotateReturn_946aceb2a550213d23b1c533b7bb4a9a = memo;\\n return vAnnotateReturn_946aceb2a550213d23b1c533b7bb4a9a;","501":"Function\\nfunction () {\\n num++;\\n }","502":"false","503":"undefined","504":"Function\\nfunction () {\\n if (ran) {\\n var vAnnotateReturn_946aceb2a550213d23b1c533b7bb4a9a = memo;\\n return vAnnotateReturn_946aceb2a550213d23b1c533b7bb4a9a;\\n }\\n ran = true;","505":"undefined","506":"true","507":"undefined","508":"null","509":"undefined","510":"Function\\nfunction (func, wrapper) {\\n var vAnnotateReturn_1d417caca1f47124a20661b45feb93db = _.partial(wrapper, func);\\n return vAnnotateReturn_1d417caca1f47124a20661b45feb93db;\\n }","511":"Function\\nfunction (name) {\\n var vAnnotateReturn_dc4f4aaf2dce1710557a1cc40bbc7ab2 = \'hi: \' + name;\\n return vAnnotateReturn_dc4f4aaf2dce1710557a1cc40bbc7ab2;\\n }","512":"Function\\nfunction (func, name) {\\n var vAnnotateReturn_67b675f5c9ce2af737a79f9418e70929 = func(name) + \' \' + name.split(\'\').reverse().join(\'\');\\n return vAnnotateReturn_67b675f5c9ce2af737a79f9418e70929;\\n }","513":"Function\\nfunction () {\\n var position = 0;\\n var args = boundArgs.slice();\\n for (var i = 0, length = args.length; i &lt; length; i++) {\\n if (args[i] === _) {\\n args[i] = arguments[position++];","514":"Function\\nfunction (predicate) {\\n var vAnnotateReturn_847d446398fdfd86bdaa40cb8d684483 = function () {\\n var vAnnotateReturn_6931abe7243268c77977d7f5eab03309 = !predicate.apply(this, arguments);\\n return vAnnotateReturn_6931abe7243268c77977d7f5eab03309;\\n };\\n return vAnnotateReturn_847d446398fdfd86bdaa40cb8d684483;","515":"Function\\nfunction (num) {\\n var vAnnotateReturn_495b7bf13bbc34e14f1dfb027c9f4b60 = num % 2 == 0;\\n return vAnnotateReturn_495b7bf13bbc34e14f1dfb027c9f4b60;\\n }","516":"Function\\nfunction () {\\n var vAnnotateReturn_6931abe7243268c77977d7f5eab03309 = !predicate.apply(this, arguments);\\n return vAnnotateReturn_6931abe7243268c77977d7f5eab03309;\\n }","517":"true","518":"Function\\nfunction () {\\n var funcs = arguments;\\n var vAnnotateReturn_a46f0fbc5805347a00a3e67a649808b8 = function () {\\n var args = arguments;\\n for (var i = funcs.length - 1; i &gt;= 0; i--) {\\n args = [funcs[i].apply(this, args)];","519":"Object (0 values, 2 functions) \\\"[object Arguments]\\\"\\n{   0: function\\n    1: function\\n}","520":"Function\\nfunction () {\\n var args = arguments;\\n for (var i = funcs.length - 1; i &gt;= 0; i--) {\\n args = [funcs[i].apply(this, args)];\\n }\\n var vAnnotateReturn_2abd0d9c8ccabe8ac2077d6de837f423 = args[0];","521":"Object (1 values, 0 functions) \\\"[object Arguments]\\\"\\n{   0: moe\\n}","522":{"vaType":"list","items":["\\\"hi: moe\\\""],"length":1},"523":"\\\"hi: moe!\\\"","524":"Function\\nfunction (times, func) {\\n var vAnnotateReturn_b8ec4092dd9cf2cb123179dafcad01db = function () {\\n if (--times &lt; 1) {\\n var vAnnotateReturn_f39ee2666ed935870881fc284b865cf3 = func.apply(this, arguments);\\n return vAnnotateReturn_f39ee2666ed935870881fc284b865cf3;\\n }","525":"5","526":"Function\\nfunction () {\\n afterCalled++;\\n }","527":"Function\\nfunction () {\\n if (--times &lt; 1) {\\n var vAnnotateReturn_f39ee2666ed935870881fc284b865cf3 = func.apply(this, arguments);\\n return vAnnotateReturn_f39ee2666ed935870881fc284b865cf3;\\n }\\n }","528":"undefined","529":"Function\\nfunction (obj) {\\n if (!_.isObject(obj)) {\\n var vAnnotateReturn_7731b6a0598a678a51ee64c0e10a8a03 = [];\\n return vAnnotateReturn_7731b6a0598a678a51ee64c0e10a8a03;\\n }\\n if (nativeKeys) {","530":"Object (5 values, 0 functions) \\\"[object Object]\\\"\\n{   &: &amp;\\n    &lt;: &lt;\\n    &gt;: &gt;\\n    \\\": &quot;\\n    \': &#x27;\\n}","531":{"vaType":"list","items":[],"length":0},"532":"Array[5]\\n[&,\\n&lt;, \\n&gt;, ...]","535":"Function\\nfunction (obj) {\\n var keys = _.keys(obj);\\n var length = keys.length;\\n var values = new Array(length);\\n for (var i = 0; i &lt; length; i++) {\\n values[i] = obj[keys[i]];","536":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   one: 1\\n    two: 2\\n    three: 3\\n}","537":{"vaType":"list","items":["\\\"one\\\"","\\\"two\\\"","\\\"three\\\""],"length":3},"538":"3","539":{"vaType":"list","items":["undefined","undefined","undefined"],"length":3},"540":"1","541":{"vaType":"list","items":["1","2","3"],"length":3},"542":"Function\\nfunction (obj) {\\n var keys = _.keys(obj);\\n var length = keys.length;\\n var pairs = new Array(length);\\n for (var i = 0; i &lt; length; i++) {\\n pairs[i] = [","543":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   moe: 30\\n    larry: 40\\n    curly: 50\\n}","544":{"vaType":"list","items":["\\\"moe\\\"","\\\"larry\\\"","\\\"curly\\\""],"length":3},"545":"3","546":{"vaType":"list","items":["undefined","undefined","undefined"],"length":3},"547":{"vaType":"list","items":["\\\"moe\\\"","30"],"length":2},"548":{"vaType":"list","items":[{"vaType":"list","items":["\\\"moe\\\"","30"],"length":2},{"vaType":"list","items":["\\\"larry\\\"","40"],"length":2},{"vaType":"list","items":["\\\"curly\\\"","50"],"length":2}],"length":3},"549":"Function\\nfunction (obj) {\\n var result = {};\\n var keys = _.keys(obj);\\n for (var i = 0, length = keys.length; i &lt; length; i++) {\\n result[obj[keys[i]]] = keys[i];\\n }","550":"Object (5 values, 0 functions) \\\"[object Object]\\\"\\n{   &: &amp;\\n    &lt;: &lt;\\n    &gt;: &gt;\\n    \\\": &quot;\\n    \': &#x27;\\n}","551":"Object \\\"[object Object]\\\"\\n{}","552":"Array[5]\\n[&,\\n&lt;, \\n&gt;, ...]","553":"\\\"&\\\"","554":"Object (5 values, 0 functions) \\\"[object Object]\\\"\\n{   &amp;: &\\n    &lt;: &lt;\\n    &gt;: &gt;\\n    &quot;: \\\"\\n    &#x27;: \'\\n}","555":"Function\\nfunction (obj) {\\n var names = [];\\n for (var key in obj) {\\n if (_.isFunction(obj[key])) {\\n names.push(key);\\n }","557":"Function\\nfunction (obj) {\\n if (obj instanceof _) {\\n var vAnnotateReturn_16f7815349fb8f6ec99efd5969b52f79 = obj;\\n return vAnnotateReturn_16f7815349fb8f6ec99efd5969b52f79;\\n }\\n if (!(this instanceof _)) {","558":{"vaType":"list","items":[],"length":0},"559":"Array[115]\\n[after,\\nall, \\nany, ...]","560":"Function\\nfunction (obj) {\\n if (!_.isObject(obj)) {\\n var vAnnotateReturn_a20c0d7a5301f4238fdf0efc7fdd6315 = obj;\\n return vAnnotateReturn_a20c0d7a5301f4238fdf0efc7fdd6315;\\n }\\n _.each(slice.call(arguments, 1), function (source) {","561":"Object (0+ values, 100+ functions) \\\"[object Object]\\\"\\n{   after: function\\n    all: function\\n    any: function\\n    bind: function\\n    bindAll: function\\n(...)\\n}","562":"null","563":"Object (0 values, 2 functions) \\\"[object Object]\\\"\\n{   chain: function\\n    value: function\\n}","564":"Function\\nfunction () {\\n this._chain = true;\\n var vAnnotateReturn_7c42b0b1743dd0d2463628a735130b59 = this;\\n return vAnnotateReturn_7c42b0b1743dd0d2463628a735130b59;\\n }","565":"Object (0+ values, 100+ functions) \\\"[object Object]\\\"\\n{   after: function\\n    all: function\\n    any: function\\n    bind: function\\n    bindAll: function\\n(...)\\n}","566":"Function\\nfunction (obj, iterator, context) {\\n var result = {};\\n if (_.isFunction(iterator)) {\\n for (var key in obj) {\\n var value = obj[key];\\n if (iterator.call(context, value, key, obj)) {","567":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n    b: 2\\n    c: 3\\n}","568":"\\\"a\\\"","569":"\\\"c\\\"","570":"Object \\\"[object Object]\\\"\\n{}","571":"1","572":"1","573":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n    c: 3\\n}","574":"Function\\nfunction (obj, iterator, context) {\\n var keys;\\n if (_.isFunction(iterator)) {\\n iterator = _.negate(iterator);\\n } else {\\n keys = _.map(concat.apply([], slice.call(arguments, 1)), String);","575":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n    b: 2\\n    c: 3\\n}","576":"\\\"b\\\"","577":"undefined","578":"undefined","579":"Function\\nfunction () {\\n var vAnnotateReturn_6931abe7243268c77977d7f5eab03309 = !predicate.apply(this, arguments);\\n return vAnnotateReturn_6931abe7243268c77977d7f5eab03309;\\n }","580":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n    c: 3\\n}","581":"Function\\nfunction (obj) {\\n if (!_.isObject(obj)) {\\n var vAnnotateReturn_f58210c13c79169ae2cf15298c04478a = obj;\\n return vAnnotateReturn_f58210c13c79169ae2cf15298c04478a;\\n }\\n _.each(slice.call(arguments, 1), function (source) {","582":"Object (5 values, 0 functions) \\\"[object Object]\\\"\\n{   zero: 0\\n    one: 1\\n    empty: \\n    nan: NaN\\n    nothing: null\\n}","583":"null","584":"Object (4 values, 0 functions) \\\"[object Object]\\\"\\n{   zero: 1\\n    one: 10\\n    twenty: 20\\n    nothing: str\\n}","585":"20","586":"Object (6 values, 0 functions) \\\"[object Object]\\\"\\n{   zero: 0\\n    one: 1\\n    empty: \\n    nan: NaN\\n    nothing: null\\n(...)\\n}","587":"Function\\nfunction (obj) {\\n if (!_.isObject(obj)) {\\n var vAnnotateReturn_889c9c8b6b4fe1039ecf14d976ef7a6e = obj;\\n return vAnnotateReturn_889c9c8b6b4fe1039ecf14d976ef7a6e;\\n }\\n var vAnnotateReturn_cffc67f628ec3a02841e08d947970f51 = _.isArray(obj) ? obj.slice() : _.extend({}, obj);","588":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   name: moe\\n    lucky: 13,27,34\\n}","589":"undefined","590":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   name: moe\\n    lucky: 13,27,34\\n}","591":"Function\\nfunction (obj, interceptor) {\\n interceptor(obj);\\n var vAnnotateReturn_ce80bf3626035be524dbd162ce3f12ac = obj;\\n return vAnnotateReturn_ce80bf3626035be524dbd162ce3f12ac;\\n }","592":"1","593":"Function\\nfunction (obj) {\\n intercepted = obj;\\n }","594":"1","595":"Function\\nfunction (a, b, aStack, bStack) {\\n if (a === b) {\\n var vAnnotateReturn_46a6c47708918a5b5775b856d103d400 = a !== 0 || 1 / a == 1 / b;\\n return vAnnotateReturn_46a6c47708918a5b5775b856d103d400;\\n }\\n if (a == null || b == null) {","596":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   moe: 30\\n    larry: 40\\n    curly: 50\\n}","597":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   moe: 30\\n    larry: 40\\n    curly: 50\\n}","598":{"vaType":"list","items":[],"length":0},"599":{"vaType":"list","items":[],"length":0},"600":"true","601":"false","602":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   x: 1\\n    y: undefined\\n}","603":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   x: 1\\n    z: 2\\n}","604":"\\\"[object Object]\\\"","605":"false","606":"false","607":"0","608":"true","609":"Function\\nfunction Object() { [native code] }","610":"Function\\nfunction Object() { [native code] }","611":"false","612":"0","613":"true","614":"2","615":"true","616":"true","617":"Function\\nfunction (a, b) {\\n var vAnnotateReturn_a2afe1c0ad4176095d8880e933d9c0b5 = eq(a, b, [], []);\\n return vAnnotateReturn_a2afe1c0ad4176095d8880e933d9c0b5;\\n }","618":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   moe: 30\\n    larry: 40\\n    curly: 50\\n}","619":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   moe: 30\\n    larry: 40\\n    curly: 50\\n}","620":"true","621":"Function\\nfunction (obj) {\\n if (obj == null) {\\n var vAnnotateReturn_5a095ae2f1e18daeb74f84ecd7d66685 = true;\\n return vAnnotateReturn_5a095ae2f1e18daeb74f84ecd7d66685;\\n }\\n if (_.isArray(obj) || _.isString(obj) || _.isArguments(obj)) {","622":{"vaType":"list","items":["1"],"length":1},"623":"true","624":"false","626":"true","627":"Function\\nfunction (obj) {\\n var vAnnotateReturn_a5b8a85cad1f0ba3c1abfcad159d7cfa = !!(obj && obj.nodeType === 1);\\n return vAnnotateReturn_a5b8a85cad1f0ba3c1abfcad159d7cfa;\\n }","628":"\\\"div\\\"","629":"false","630":"Function\\nfunction isArray() { [native code] }","631":"Function\\nfunction (obj) {\\n var vAnnotateReturn_155e04c636f59c965b926fd00491bb11 = obj === Object(obj);\\n return vAnnotateReturn_155e04c636f59c965b926fd00491bb11;\\n }","632":"Object (5 values, 0 functions) \\\"[object Object]\\\"\\n{   &: &amp;\\n    &lt;: &lt;\\n    &gt;: &gt;\\n    \\\": &quot;\\n    \': &#x27;\\n}","633":"true","634":"\\\"Arguments\\\"","635":"Function\\nfunction (obj) {\\n var vAnnotateReturn_088ffae98878b897c06daf9eded4e768 = toString.call(obj) == \'[object \' + name + \']\';\\n return vAnnotateReturn_088ffae98878b897c06daf9eded4e768;\\n }","636":"Object \\\"[object Arguments]\\\"\\n{}","637":"true","641":"Function\\nfunction (obj) {\\n var vAnnotateReturn_5cd94c9f7fdd740abb79c3ea5e1f2138 = typeof obj === \'function\';\\n return vAnnotateReturn_5cd94c9f7fdd740abb79c3ea5e1f2138;\\n }","642":"\\\"1.6.0\\\"","643":"false","644":"Function\\nfunction (obj) {\\n var vAnnotateReturn_aff5a269af863c4220a67be8b6ab6190 = isFinite(obj) && !isNaN(parseFloat(obj));\\n return vAnnotateReturn_aff5a269af863c4220a67be8b6ab6190;\\n }","645":"undefined","646":"false","647":"Function\\nfunction (obj) {\\n var vAnnotateReturn_7e2153052cd9b2154f5c7286ef69b49f = _.isNumber(obj) && obj != +obj;\\n return vAnnotateReturn_7e2153052cd9b2154f5c7286ef69b49f;\\n }","648":"NaN","649":"true","650":"Function\\nfunction (obj) {\\n var vAnnotateReturn_582fefe33dcc97a7e4c281142d879d85 = obj === true || obj === false || toString.call(obj) == \'[object Boolean]\';\\n return vAnnotateReturn_582fefe33dcc97a7e4c281142d879d85;\\n }","651":"2","652":"false","653":"Function\\nfunction (obj) {\\n var vAnnotateReturn_19ac3b3e6fb447a4bf332d9f48ece9f5 = obj === null;\\n return vAnnotateReturn_19ac3b3e6fb447a4bf332d9f48ece9f5;\\n }","654":"undefined","655":"false","656":"Function\\nfunction (obj) {\\n var vAnnotateReturn_995560e3ddb9f6251ee5281e79648c01 = obj === void 0;\\n return vAnnotateReturn_995560e3ddb9f6251ee5281e79648c01;\\n }","657":"undefined","658":"true","659":"Function\\nfunction (obj, key) {\\n var vAnnotateReturn_8fd3a52eb55555f7ac055fcc20fbe835 = obj != null && hasOwnProperty.call(obj, key);\\n return vAnnotateReturn_8fd3a52eb55555f7ac055fcc20fbe835;\\n }","660":"Object \\\"[object Object]\\\"\\n{}","661":"1","662":"false","663":"Function\\nfunction () {\\n root._ = previousUnderscore;\\n var vAnnotateReturn_4dd8c2b269e69a64cc1af9a59b0c2bd6 = this;\\n return vAnnotateReturn_4dd8c2b269e69a64cc1af9a59b0c2bd6;\\n }","666":"Function\\nfunction (value) {\\n var vAnnotateReturn_849caf17aa5dd2217f0c18f767165652 = value;\\n return vAnnotateReturn_849caf17aa5dd2217f0c18f767165652;\\n }","667":"Object \\\"[object Object]\\\"\\n{}","668":"Object \\\"[object Object]\\\"\\n{}","669":"Function\\nfunction (value) {\\n var vAnnotateReturn_9f983b0fa65a26eb28be80598773c8b9 = function () {\\n var vAnnotateReturn_fac1bc268150a4233c9d269edc9176ed = value;\\n return vAnnotateReturn_fac1bc268150a4233c9d269edc9176ed;\\n };\\n return vAnnotateReturn_9f983b0fa65a26eb28be80598773c8b9;","670":"Object (1 values, 0 functions) \\\"[object Object]\\\"\\n{   name: moe\\n}","671":"Function\\nfunction () {\\n var vAnnotateReturn_fac1bc268150a4233c9d269edc9176ed = value;\\n return vAnnotateReturn_fac1bc268150a4233c9d269edc9176ed;\\n }","672":"Object (1 values, 0 functions) \\\"[object Object]\\\"\\n{   name: moe\\n}","673":"Function\\nfunction () {\\n }","674":"Function\\nfunction (key) {\\n var vAnnotateReturn_2484e970f82ba4b2b4c2e4ab35345341 = function (obj) {\\n var vAnnotateReturn_9a912735814c6171e820988ea0e08a38 = obj[key];\\n return vAnnotateReturn_9a912735814c6171e820988ea0e08a38;\\n };\\n return vAnnotateReturn_2484e970f82ba4b2b4c2e4ab35345341;","675":"\\\"name\\\"","676":"Function\\nfunction (obj) {\\n var vAnnotateReturn_9a912735814c6171e820988ea0e08a38 = obj[key];\\n return vAnnotateReturn_9a912735814c6171e820988ea0e08a38;\\n }","677":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   name: moe\\n    age: 30\\n}","678":"\\\"moe\\\"","679":"Function\\nfunction (attrs) {\\n var vAnnotateReturn_e052f542ac121f35161d770c753d2ef6 = function (obj) {\\n if (obj == null) {\\n var vAnnotateReturn_91f5c231ff355c328fb283d924c6155a = _.isEmpty(attrs);\\n return vAnnotateReturn_91f5c231ff355c328fb283d924c6155a;\\n }","680":"Object (1 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n}","681":"Function\\nfunction (obj) {\\n if (obj == null) {\\n var vAnnotateReturn_91f5c231ff355c328fb283d924c6155a = _.isEmpty(attrs);\\n return vAnnotateReturn_91f5c231ff355c328fb283d924c6155a;\\n }\\n if (obj === attrs) {","682":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   a: 1\\n    b: 2\\n}","683":"false","684":"true","686":"true","687":"Function\\nfunction (n, iterator, context) {\\n var accum = Array(Math.max(0, n));\\n for (var i = 0; i &lt; n; i++)\\n accum[i] = iterator.call(context, i);\\n var vAnnotateReturn_299347682a20ed65aafca197e7ec5bdc = accum;\\n return vAnnotateReturn_299347682a20ed65aafca197e7ec5bdc;","688":"3","689":"Function\\nfunction (i) {\\n vals.push(i);\\n }","690":"undefined","691":{"vaType":"list","items":["undefined","undefined","undefined"],"length":3},"693":{"vaType":"list","items":["undefined","undefined","undefined"],"length":3},"694":"Function\\nfunction (min, max) {\\n if (max == null) {\\n max = min;\\n min = 0;\\n }\\n var vAnnotateReturn_e0560239c836cbd0aa742deae571892f = min + Math.floor(Math.random() * (max - min + 1));","700":"Function\\nfunction now() { [native code] }","701":"Object (1 values, 0 functions) \\\"[object Object]\\\"\\n{   escape: [object Object]\\n}","702":"Object (5 values, 0 functions) \\\"[object Object]\\\"\\n{   &amp;: &\\n    &lt;: &lt;\\n    &gt;: &gt;\\n    &quot;: \\\"\\n    &#x27;: \'\\n}","703":"Object (2 values, 0 functions) \\\"[object Object]\\\"\\n{   escape: /[&&lt;&gt;\\\"\']/g\\n    unescape: /(&amp;|&lt;|&gt;|&quot;|&#x27;)/g\\n}","704":"\\\"escape\\\"","705":"Function\\nfunction (string) {\\n if (string == null) {\\n var vAnnotateReturn_0b51288cb745a8cdc8819bdee48ded77 = \'\';\\n return vAnnotateReturn_0b51288cb745a8cdc8819bdee48ded77;\\n }\\n var vAnnotateReturn_d2020a30ba67450ff9ba3cebb3aed986 = (\'\' + string).replace(entityRegexes[method], function (match) {","706":"\\\"Curly & Moe\\\"","707":"\\\"\\\"","708":"\\\"Curly &amp; Moe\\\"","709":"\\\"&\\\"","710":"\\\"&amp;\\\"","711":"Function\\nfunction (object, property) {\\n if (object == null) {\\n var vAnnotateReturn_78bb2012d4f3fb3c965d4f149bf65d75 = void 0;\\n return vAnnotateReturn_78bb2012d4f3fb3c965d4f149bf65d75;\\n }\\n var value = object[property];","712":"Object (2 values, 1 functions) \\\"[object Object]\\\"\\n{   w: \\n    x: x\\n    y: function\\n}","713":"\\\"w\\\"","714":"undefined","715":"\\\"\\\"","716":"\\\"\\\"","717":"Function\\nfunction (obj) {\\n _.each(_.functions(obj), function (name) {\\n var func = _[name] = obj[name];\\n _.prototype[name] = function () {\\n var args = [this._wrapped];\\n push.apply(args, arguments);","718":"Function\\nfunction (obj) {\\n if (obj instanceof _) {\\n var vAnnotateReturn_16f7815349fb8f6ec99efd5969b52f79 = obj;\\n return vAnnotateReturn_16f7815349fb8f6ec99efd5969b52f79;\\n }\\n if (!(this instanceof _)) {","719":"\\\"after\\\"","720":"Function\\nfunction (times, func) {\\n var vAnnotateReturn_b8ec4092dd9cf2cb123179dafcad01db = function () {\\n if (--times &lt; 1) {\\n var vAnnotateReturn_f39ee2666ed935870881fc284b865cf3 = func.apply(this, arguments);\\n return vAnnotateReturn_f39ee2666ed935870881fc284b865cf3;\\n }","722":"Function\\nfunction () {\\n var args = [this._wrapped];\\n push.apply(args, arguments);\\n var vAnnotateReturn_0695d3d8189f489a54f2bff590a43347 = result.call(this, func.apply(_, args));\\n return vAnnotateReturn_0695d3d8189f489a54f2bff590a43347;\\n }","723":{"vaType":"list","items":[{"vaType":"list","items":["1","2","3"],"length":3}],"length":1},"724":{"vaType":"list","items":["2","4","6"],"length":3},"725":"0","726":"Function\\nfunction (prefix) {\\n var id = ++idCounter + \'\';\\n var vAnnotateReturn_9a4d6931c381645e0a2dc8f3cd36287c = prefix ? prefix + id : id;\\n return vAnnotateReturn_9a4d6931c381645e0a2dc8f3cd36287c;\\n }","727":"undefined","728":"\\\"1\\\"","729":"\\\"1\\\"","730":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   evaluate: /&lt;%([\\\\s\\\\S]+?)%&gt;/g\\n    interpolate: /&lt;%=([\\\\s\\\\S]+?)%&gt;/g\\n    escape: /&lt;%-([\\\\s\\\\S]+?)%&gt;/g\\n}","731":"Object \\\"/(.)^/\\\"\\n{}","732":"Object (6 values, 0 functions) \\\"[object Object]\\\"\\n{   \': \'\\n    \\\\: \\\\\\n    \\r: r\\n    \\\\u000a: n\\n    \\\\u2028: u2028\\n(...)\\n}","733":"Object \\\"/\\\\\\\\|\'|\\\\r|\\\\n|\\\\u2028|\\\\u2029/g\\\"\\n{}","734":"Function\\nfunction (match) {\\n var vAnnotateReturn_85bd30594109752b2c5ee4a008f4cfbe = \'\\\\\\\\\' + escapes[match];\\n return vAnnotateReturn_85bd30594109752b2c5ee4a008f4cfbe;\\n }","735":"\\\"\'\\\"","736":"\\\"\\\\\'\\\"","737":"Function\\nfunction (text, data, settings) {\\n settings = _.defaults({}, settings, _.templateSettings);\\n var matcher = new RegExp([\\n (settings.escape || noMatch).source,\\n (settings.interpolate || noMatch).source,\\n (settings.evaluate || noMatch).source","738":"\\\"&lt;%= thing %&gt; is gettin\' on my noives!\\\"","739":"undefined","740":"undefined","741":"Object (3 values, 0 functions) \\\"[object Object]\\\"\\n{   evaluate: /&lt;%([\\\\s\\\\S]+?)%&gt;/g\\n    interpolate: /&lt;%=([\\\\s\\\\S]+?)%&gt;/g\\n    escape: /&lt;%-([\\\\s\\\\S]+?)%&gt;/g\\n}","742":"Object \\\"/&lt;%-([\\\\s\\\\S]+?)%&gt;|&lt;%=([\\\\s\\\\S]+?)...\\\"\\n{}","743":"0","744":"\\\"__p+=\'\\\"","745":"\\\"&lt;%= thing %&gt;\\\"","746":"undefined","747":"\\\" thing \\\"","748":"undefined","749":"0","750":"\\\"__p+=\'\\\"","751":"12","752":"\\\"__p+=\'&lt;i&gt;\'+\\\\u000a((__t=( value ))==null?\'\':_.escape(__t))+\\\\u000a\'\\\"","753":"\\\"&lt;%= thing %&gt;\\\"","754":"\\\"__p+=\'\'+\\\\u000a((__t=( thing ))==null?\'\':__t)+\\\\u000a\' is gettin\\\\\' on my noives!\';\\\\u000a\\\"","755":"\\\"with(obj||{}){\\\\u000a__p+=\'\'+\\\\u000a((__t=( thing ))==null?\'\':__t)+\\\\u000a\' is gettin\\\\\' on my noives!\';\\\\u000a}\\\\u000a\\\"","756":"\\\"var __t,__p=\'\',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,\'\');};\\\\u000awith(obj||{}){\\\\u000a__p+=\'\'+\\\\u000a((__t=( thing ))==null?\'\':__t)+\\\\u000a\' is gettin\\\\\' on my noives!\';\\\\u000a}\\\\u000areturn __p;\\\\u000a\\\"","757":"\\\"x\\\"","758":"Function\\nfunction (data) {\\n var vAnnotateReturn_5d409a7f36390cff5e7dcb49695ca575 = render.call(this, data, _);\\n return vAnnotateReturn_5d409a7f36390cff5e7dcb49695ca575;\\n }","759":"Object (1 values, 0 functions) \\\"[object Object]\\\"\\n{   thing: This\\n}","760":"\\\"This is gettin\' on my noives!\\\"","761":"\\\"obj\\\"","762":"\\\"function(obj){\\\\u000avar __t,__p=\'\',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,\'\');};\\\\u000awith(obj||{}){\\\\u000a__p+=\'\'+\\\\u000a((__t=( thing ))==null?\'\':__t)+\\\\u000a\' is gettin\\\\\' on my noives!\';\\\\u000a}\\\\u000areturn __p;\\\\u000a}\\\"","763":"Function\\nfunction (data) {\\n var vAnnotateReturn_5d409a7f36390cff5e7dcb49695ca575 = render.call(this, data, _);\\n return vAnnotateReturn_5d409a7f36390cff5e7dcb49695ca575;\\n }","764":"Function\\nfunction (obj) {\\n var vAnnotateReturn_2bcd177bc4e7cbb7c8cd8e214f6ccf82 = _(obj).chain();\\n return vAnnotateReturn_2bcd177bc4e7cbb7c8cd8e214f6ccf82;\\n }","765":"Array[10]\\n[1,\\n2, \\n3, ...]","766":"Object (2+ values, 98+ functions) \\\"[object Object]\\\"\\n{   _wrapped: 1,2,3,4,5,6,7,8,9,10\\n    _chain: true\\n    after: function\\n    all: function\\n    any: function\\n(...)\\n}","767":"Function\\nfunction (obj) {\\n var vAnnotateReturn_cbb53edc62939e752f64e090eae9e3e5 = this._chain ? _(obj).chain() : obj;\\n return vAnnotateReturn_cbb53edc62939e752f64e090eae9e3e5;\\n }","768":{"vaType":"list","items":["2","4","6"],"length":3},"769":{"vaType":"list","items":["2","4","6"],"length":3},"770":"\\\"pop\\\"","771":"Function\\nfunction pop() { [native code] }","772":"Function\\nfunction () {\\n var obj = this._wrapped;\\n method.apply(obj, arguments);\\n if ((name == \'shift\' || name == \'splice\') && obj.length === 0) {\\n delete obj[0];\\n }","773":"Array[5]\\n[1,\\n2, \\n3, ...]","774":"Object (2+ values, 98+ functions) \\\"[object Object]\\\"\\n{   _wrapped: 5,4,3,2,1\\n    _chain: true\\n    after: function\\n    all: function\\n    any: function\\n(...)\\n}","775":"\\\"concat\\\"","776":"Function\\nfunction concat() { [native code] }","777":"Function\\nfunction () {\\n var vAnnotateReturn_7d48afde67dbb27cb5daf0c6cb1be9d7 = result.call(this, method.apply(this._wrapped, arguments));\\n return vAnnotateReturn_7d48afde67dbb27cb5daf0c6cb1be9d7;\\n }","778":"Object (2+ values, 98+ functions) \\\"[object Object]\\\"\\n{   _wrapped: 5,4,3,2,1,5,5,5\\n    _chain: true\\n    after: function\\n    all: function\\n    any: function\\n(...)\\n}","779":"true","780":"Object (2+ values, 98+ functions) \\\"[object Object]\\\"\\n{   _wrapped: [object Object]\\n    _chain: true\\n    after: function\\n    all: function\\n    any: function\\n(...)\\n}","781":"6"},"setup":[{"id":0,"range":[363,367]},{"id":1,"range":[433,451]},{"id":2,"range":[548,555]},{"id":3,"range":[628,638]},{"id":4,"range":[658,666]},{"id":5,"range":[687,696]},{"id":6,"range":[805,809]},{"id":7,"range":[845,850]},{"id":8,"range":[886,892]},{"id":9,"range":[928,936]},{"id":10,"range":[970,984]},{"id":11,"range":[1127,1140]},{"id":12,"range":[1167,1177]},{"id":13,"range":[1205,1215]},{"id":14,"range":[1318,1319]},{"id":15,"range":[1331,1334]},{"id":16,"range":[1364,1370]},{"id":17,"range":[1406,1412]},{"id":18,"range":[1429,1442]},{"id":19,"range":[1800,1807]},{"id":20,"range":[1810,1824]},{"id":21,"range":[1840,1849]},{"id":22,"range":[1911,1920]},{"id":23,"range":[2162,2168]},{"id":24,"range":[2171,2180]},{"id":25,"range":[2192,2195]},{"id":26,"range":[2197,2205]},{"id":27,"range":[2207,2214]},{"id":28,"range":[2239,2245]},{"id":29,"range":[2415,2421]},{"id":30,"range":[2639,2645]},{"id":31,"range":[2725,2730]},{"id":32,"range":[2733,2742]},{"id":33,"range":[2754,2757]},{"id":34,"range":[2759,2767]},{"id":35,"range":[2769,2776]},{"id":36,"range":[2788,2795]},{"id":37,"range":[2823,2829]},{"id":38,"range":[2864,2869]},{"id":39,"range":[2871,2876]},{"id":40,"range":[2878,2882]},{"id":41,"range":[2962,2968]},{"id":42,"range":[2990,3001]},{"id":43,"range":[3150,3158]},{"id":44,"range":[3161,3168]},{"id":45,"range":[3171,3179]},{"id":46,"range":[3191,3194]},{"id":47,"range":[3196,3204]},{"id":48,"range":[3206,3210]},{"id":49,"range":[3212,3219]},{"id":50,"range":[3231,3238]},{"id":51,"range":[3284,3287]},{"id":52,"range":[3319,3324]},{"id":53,"range":[3326,3331]},{"id":54,"range":[3333,3337]},{"id":55,"range":[3371,3375]},{"id":56,"range":[3393,3400]},{"id":57,"range":[3561,3567]},{"id":58,"range":[3651,3664]},{"id":59,"range":[3667,3674]},{"id":60,"range":[3686,3689]},{"id":61,"range":[3691,3699]},{"id":62,"range":[3701,3705]},{"id":63,"range":[3707,3714]},{"id":64,"range":[3726,3733]},{"id":65,"range":[3779,3782]},{"id":66,"range":[3797,3803]},{"id":67,"range":[3858,3862]},{"id":68,"range":[3884,3890]},{"id":69,"range":[3937,3942]},{"id":70,"range":[3944,3949]},{"id":71,"range":[3951,3955]},{"id":72,"range":[3965,3970]},{"id":73,"range":[4037,4041]},{"id":74,"range":[4064,4071]},{"id":75,"range":[4237,4243]},{"id":76,"range":[4334,4340]},{"id":77,"range":[4343,4351]},{"id":78,"range":[4363,4366]},{"id":79,"range":[4368,4377]},{"id":80,"range":[4379,4386]},{"id":81,"range":[4398,4404]},{"id":82,"range":[4431,4436]},{"id":83,"range":[4438,4443]},{"id":84,"range":[4445,4449]},{"id":85,"range":[4518,4524]},{"id":86,"range":[4542,4548]},{"id":87,"range":[4575,4581]},{"id":88,"range":[4677,4685]},{"id":89,"range":[4688,4696]},{"id":90,"range":[4708,4711]},{"id":91,"range":[4713,4722]},{"id":92,"range":[4724,4731]},{"id":93,"range":[4743,4750]},{"id":94,"range":[4778,4784]},{"id":95,"range":[4819,4824]},{"id":96,"range":[4826,4831]},{"id":97,"range":[4833,4837]},{"id":98,"range":[4929,4935]},{"id":99,"range":[5012,5020]},{"id":100,"range":[5032,5035]},{"id":101,"range":[5037,5046]},{"id":102,"range":[5048,5055]},{"id":103,"range":[5063,5069]},{"id":104,"range":[5209,5216]},{"id":105,"range":[5219,5224]},{"id":106,"range":[5236,5239]},{"id":107,"range":[5241,5250]},{"id":108,"range":[5252,5259]},{"id":109,"range":[5314,5320]},{"id":110,"range":[5350,5356]},{"id":111,"range":[5390,5395]},{"id":112,"range":[5397,5402]},{"id":113,"range":[5404,5408]},{"id":114,"range":[5489,5495]},{"id":115,"range":[5517,5523]},{"id":116,"range":[5640,5646]},{"id":117,"range":[5649,5654]},{"id":118,"range":[5666,5669]},{"id":119,"range":[5671,5680]},{"id":120,"range":[5682,5689]},{"id":121,"range":[5744,5750]},{"id":122,"range":[5781,5787]},{"id":123,"range":[5821,5826]},{"id":124,"range":[5828,5833]},{"id":125,"range":[5835,5839]},{"id":126,"range":[5919,5925]},{"id":127,"range":[5947,5953]},{"id":128,"range":[6075,6085]},{"id":129,"range":[6088,6097]},{"id":130,"range":[6109,6112]},{"id":131,"range":[6114,6120]},{"id":132,"range":[6145,6151]},{"id":133,"range":[6195,6201]},{"id":134,"range":[6235,6241]},{"id":135,"range":[6263,6268]},{"id":136,"range":[6278,6284]},{"id":137,"range":[6388,6396]},{"id":138,"range":[6408,6411]},{"id":139,"range":[6413,6419]},{"id":140,"range":[6431,6435]},{"id":141,"range":[6472,6478]},{"id":142,"range":[6507,6513]},{"id":143,"range":[6534,6539]},{"id":144,"range":[6549,6555]},{"id":145,"range":[6703,6710]},{"id":146,"range":[6722,6725]},{"id":147,"range":[6727,6730]},{"id":148,"range":[6738,6744]},{"id":149,"range":[6908,6915]},{"id":150,"range":[6927,6930]},{"id":151,"range":[6932,6937]},{"id":152,"range":[6945,6951]},{"id":153,"range":[7119,7130]},{"id":154,"range":[7142,7145]},{"id":155,"range":[7147,7152]},{"id":156,"range":[7160,7166]},{"id":157,"range":[7270,7275]},{"id":158,"range":[7287,7290]},{"id":159,"range":[7292,7300]},{"id":160,"range":[7302,7309]},{"id":161,"range":[7321,7327]},{"id":162,"range":[7341,7353]},{"id":163,"range":[7375,7380]},{"id":164,"range":[7382,7390]},{"id":165,"range":[7501,7506]},{"id":166,"range":[7557,7563]},{"id":167,"range":[7917,7923]},{"id":168,"range":[8004,8009]},{"id":169,"range":[8021,8024]},{"id":170,"range":[8026,8034]},{"id":171,"range":[8036,8043]},{"id":172,"range":[8055,8061]},{"id":173,"range":[8074,8086]},{"id":174,"range":[8107,8112]},{"id":175,"range":[8114,8122]},{"id":176,"range":[8233,8238]},{"id":177,"range":[8289,8295]},{"id":178,"range":[8647,8653]},{"id":179,"range":[8805,8814]},{"id":180,"range":[8826,8829]},{"id":181,"range":[8841,8845]},{"id":182,"range":[8855,8860]},{"id":183,"range":[8874,8882]},{"id":184,"range":[8914,8919]},{"id":185,"range":[8929,8933]},{"id":186,"range":[8961,8980]},{"id":187,"range":[9005,9019]},{"id":188,"range":[9041,9047]},{"id":189,"range":[9247,9255]},{"id":190,"range":[9267,9270]},{"id":191,"range":[9272,9273]},{"id":192,"range":[9275,9280]},{"id":193,"range":[9352,9355]},{"id":194,"range":[9379,9385]},{"id":195,"range":[9427,9433]},{"id":196,"range":[9543,9557]},{"id":197,"range":[9569,9574]},{"id":198,"range":[9576,9583]},{"id":199,"range":[9610,9616]},{"id":200,"range":[9659,9665]},{"id":201,"range":[9703,9709]},{"id":202,"range":[9721,9727]},{"id":203,"range":[9747,9753]},{"id":204,"range":[9872,9880]},{"id":205,"range":[9892,9895]},{"id":206,"range":[9897,9905]},{"id":207,"range":[9907,9914]},{"id":208,"range":[9922,9930]},{"id":209,"range":[9972,9978]},{"id":217,"range":[10007,10012]},{"id":218,"range":[10014,10019]},{"id":219,"range":[10021,10025]},{"id":220,"range":[10035,10041]},{"id":210,"range":[10165,10169]},{"id":211,"range":[10171,10176]},{"id":212,"range":[10190,10191]},{"id":213,"range":[10219,10220]},{"id":214,"range":[10295,10301]},{"id":215,"range":[10340,10346]},{"id":216,"range":[10365,10371]},{"id":221,"range":[10496,10501]},{"id":222,"range":[10513,10521]},{"id":223,"range":[10529,10535]},{"id":224,"range":[10545,10548]},{"id":225,"range":[10550,10558]},{"id":226,"range":[10560,10567]},{"id":227,"range":[10581,10587]},{"id":228,"range":[10600,10608]},{"id":229,"range":[10673,10678]},{"id":230,"range":[10680,10685]},{"id":231,"range":[10701,10704]},{"id":232,"range":[10790,10796]},{"id":233,"range":[10959,10968]},{"id":234,"range":[10986,10992]},{"id":235,"range":[10994,10999]},{"id":236,"range":[11001,11004]},{"id":237,"range":[11228,11237]},{"id":238,"range":[11255,11261]},{"id":239,"range":[11263,11268]},{"id":240,"range":[11270,11273]},{"id":241,"range":[11281,11292]},{"id":242,"range":[11477,11486]},{"id":243,"range":[11504,11510]},{"id":244,"range":[11512,11517]},{"id":245,"range":[11519,11522]},{"id":246,"range":[11745,11758]},{"id":247,"range":[11770,11775]},{"id":248,"range":[11777,11780]},{"id":249,"range":[11782,11790]},{"id":250,"range":[11792,11799]},{"id":251,"range":[11807,11815]},{"id":252,"range":[11861,11866]},{"id":253,"range":[11892,11895]},{"id":254,"range":[11901,11905]},{"id":255,"range":[11957,11960]},{"id":256,"range":[12020,12023]},{"id":257,"range":[12058,12064]},{"id":258,"range":[12140,12149]},{"id":259,"range":[12161,12164]},{"id":260,"range":[12182,12188]},{"id":261,"range":[12217,12223]},{"id":262,"range":[12277,12283]},{"id":263,"range":[12312,12318]},{"id":264,"range":[12391,12397]},{"id":265,"range":[12409,12412]},{"id":266,"range":[12437,12443]},{"id":267,"range":[12451,12457]},{"id":268,"range":[12764,12771]},{"id":269,"range":[12774,12780]},{"id":270,"range":[12783,12789]},{"id":271,"range":[12801,12806]},{"id":272,"range":[12808,12809]},{"id":273,"range":[12811,12816]},{"id":274,"range":[12843,12849]},{"id":275,"range":[12888,12894]},{"id":276,"range":[12920,12926]},{"id":277,"range":[12935,12941]},{"id":278,"range":[13219,13228]},{"id":279,"range":[13240,13245]},{"id":280,"range":[13247,13248]},{"id":281,"range":[13250,13255]},{"id":282,"range":[13263,13269]},{"id":283,"range":[13512,13518]},{"id":284,"range":[13530,13535]},{"id":285,"range":[13537,13538]},{"id":286,"range":[13540,13545]},{"id":287,"range":[13572,13578]},{"id":288,"range":[13617,13623]},{"id":289,"range":[13653,13659]},{"id":290,"range":[13977,13983]},{"id":291,"range":[13986,13992]},{"id":292,"range":[13995,14001]},{"id":293,"range":[14013,14018]},{"id":294,"range":[14020,14021]},{"id":295,"range":[14023,14028]},{"id":296,"range":[14036,14042]},{"id":297,"range":[14146,14155]},{"id":298,"range":[14167,14172]},{"id":299,"range":[14180,14186]},{"id":300,"range":[14292,14299]},{"id":301,"range":[14311,14316]},{"id":302,"range":[14318,14325]},{"id":303,"range":[14327,14333]},{"id":304,"range":[14335,14341]},{"id":305,"range":[14399,14405]},{"id":306,"range":[14513,14518]},{"id":307,"range":[14773,14779]},{"id":308,"range":[14875,14884]},{"id":309,"range":[14896,14901]},{"id":310,"range":[14903,14910]},{"id":311,"range":[14918,14924]},{"id":312,"range":[15050,15059]},{"id":313,"range":[15071,15076]},{"id":314,"range":[15084,15090]},{"id":315,"range":[15297,15308]},{"id":316,"range":[15320,15323]},{"id":317,"range":[15325,15334]},{"id":318,"range":[15336,15343]},{"id":319,"range":[15351,15360]},{"id":320,"range":[15407,15411]},{"id":321,"range":[15418,15422]},{"id":322,"range":[15454,15459]},{"id":323,"range":[15461,15464]},{"id":324,"range":[15466,15469]},{"id":325,"range":[15547,15553]},{"id":326,"range":[15746,15752]},{"id":327,"range":[15755,15763]},{"id":328,"range":[15775,15780]},{"id":329,"range":[15782,15790]},{"id":330,"range":[15792,15800]},{"id":331,"range":[15802,15809]},{"id":332,"range":[15836,15842]},{"id":333,"range":[15887,15894]},{"id":334,"range":[15913,15921]},{"id":335,"range":[15940,15948]},{"id":336,"range":[15972,15978]},{"id":337,"range":[15993,15997]},{"id":338,"range":[16076,16081]},{"id":339,"range":[16114,16119]},{"id":340,"range":[16259,16263]},{"id":341,"range":[16353,16359]},{"id":342,"range":[16484,16491]},{"id":343,"range":[16511,16517]},{"id":344,"range":[16663,16677]},{"id":345,"range":[16689,16694]},{"id":346,"range":[16721,16727]},{"id":347,"range":[16740,16746]},{"id":348,"range":[16761,16771]},{"id":349,"range":[16864,16868]},{"id":350,"range":[17089,17095]},{"id":351,"range":[17253,17265]},{"id":352,"range":[17277,17282]},{"id":353,"range":[17294,17298]},{"id":354,"range":[17356,17362]},{"id":355,"range":[17388,17393]},{"id":356,"range":[17396,17402]},{"id":357,"range":[17544,17549]},{"id":358,"range":[17573,17579]},{"id":359,"range":[17637,17644]},{"id":360,"range":[17711,17721]},{"id":361,"range":[17762,17768]},{"id":362,"range":[17977,17985]},{"id":363,"range":[17997,18001]},{"id":364,"range":[18003,18009]},{"id":365,"range":[18035,18041]},{"id":366,"range":[18054,18060]},{"id":367,"range":[18156,18171]},{"id":368,"range":[18259,18265]},{"id":369,"range":[18518,18527]},{"id":370,"range":[18539,18544]},{"id":371,"range":[18546,18550]},{"id":372,"range":[18552,18560]},{"id":373,"range":[18587,18593]},{"id":374,"range":[18606,18607]},{"id":375,"range":[18613,18619]},{"id":376,"range":[18705,18706]},{"id":377,"range":[18932,18938]},{"id":378,"range":[18946,18952]},{"id":379,"range":[18965,18978]},{"id":380,"range":[18990,18995]},{"id":381,"range":[18997,19001]},{"id":382,"range":[19003,19007]},{"id":383,"range":[19034,19040]},{"id":384,"range":[19053,19054]},{"id":385,"range":[19132,19138]},{"id":386,"range":[19146,19152]},{"id":387,"range":[19377,19384]},{"id":388,"range":[19396,19401]},{"id":389,"range":[19403,19407]},{"id":390,"range":[19409,19413]},{"id":391,"range":[19456,19460]},{"id":392,"range":[19481,19486]},{"id":393,"range":[19502,19506]},{"id":394,"range":[19537,19543]},{"id":395,"range":[19601,19604]},{"id":396,"range":[19618,19623]},{"id":397,"range":[19678,19690]},{"id":398,"range":[19706,19711]},{"id":399,"range":[19732,19738]},{"id":400,"range":[19872,19876]},{"id":401,"range":[20069,20075]},{"id":402,"range":[20087,20091]},{"id":403,"range":[20093,20100]},{"id":404,"range":[20112,20116]},{"id":405,"range":[20118,20123]},{"id":406,"range":[20173,20179]},{"id":407,"range":[20321,20325]},{"id":408,"range":[20358,20364]},{"id":409,"range":[20365,20370]},{"id":410,"range":[20422,20428]},{"id":411,"range":[20492,20506]},{"id":412,"range":[20535,20539]},{"id":413,"range":[20558,20572]},{"id":414,"range":[20591,20597]},{"id":415,"range":[20691,20697]},{"id":416,"range":[20712,20718]},{"id":417,"range":[20977,20986]},{"id":418,"range":[20998,21002]},{"id":419,"range":[21014,21023]},{"id":420,"range":[21056,21062]},{"id":421,"range":[21086,21094]},{"id":422,"range":[21110,21114]},{"id":423,"range":[21226,21233]},{"id":424,"range":[21349,21355]},{"id":425,"range":[21591,21600]},{"id":426,"range":[21612,21615]},{"id":427,"range":[21627,21632]},{"id":428,"range":[21774,21775]},{"id":429,"range":[21779,21785]},{"id":430,"range":[21817,21823]},{"id":431,"range":[21896,21905]},{"id":432,"range":[21917,21921]},{"id":433,"range":[21923,21929]},{"id":434,"range":[21950,21956]},{"id":435,"range":[21979,21986]},{"id":436,"range":[22012,22017]},{"id":437,"range":[22045,22048]},{"id":438,"range":[22112,22122]},{"id":439,"range":[22160,22166]},{"id":440,"range":[22190,22203]},{"id":441,"range":[22214,22220]},{"id":442,"range":[22351,22358]},{"id":443,"range":[22370,22374]},{"id":444,"range":[22376,22380]},{"id":445,"range":[22392,22396]},{"id":446,"range":[22429,22435]},{"id":447,"range":[22459,22465]},{"id":448,"range":[22600,22607]},{"id":449,"range":[22619,22623]},{"id":450,"range":[22631,22637]},{"id":451,"range":[23095,23105]},{"id":452,"range":[23117,23121]},{"id":453,"range":[23123,23127]},{"id":454,"range":[23129,23136]},{"id":455,"range":[23148,23155]},{"id":456,"range":[23157,23161]},{"id":457,"range":[23163,23169]},{"id":458,"range":[23179,23186]},{"id":459,"range":[23203,23211]},{"id":460,"range":[23256,23261]},{"id":461,"range":[23283,23291]},{"id":462,"range":[23341,23348]},{"id":463,"range":[23363,23369]},{"id":464,"range":[23419,23426]},{"id":465,"range":[23429,23433]},{"id":466,"range":[23453,23459]},{"id":467,"range":[23483,23486]},{"id":468,"range":[23548,23556]},{"id":469,"range":[23574,23583]},{"id":470,"range":[23617,23624]},{"id":471,"range":[23639,23643]},{"id":472,"range":[23744,23751]},{"id":473,"range":[23768,23776]},{"id":474,"range":[23792,23798]},{"id":475,"range":[23850,23857]},{"id":476,"range":[23860,23864]},{"id":477,"range":[23994,24000]},{"id":478,"range":[24301,24311]},{"id":479,"range":[24323,24327]},{"id":480,"range":[24329,24333]},{"id":481,"range":[24335,24344]},{"id":482,"range":[24356,24363]},{"id":483,"range":[24365,24369]},{"id":484,"range":[24371,24378]},{"id":485,"range":[24380,24389]},{"id":486,"range":[24391,24397]},{"id":487,"range":[24408,24413]},{"id":488,"range":[24439,24443]},{"id":489,"range":[24513,24520]},{"id":490,"range":[24743,24749]},{"id":491,"range":[24769,24776]},{"id":492,"range":[24791,24795]},{"id":493,"range":[24815,24824]},{"id":494,"range":[24846,24853]},{"id":495,"range":[24899,24906]},{"id":496,"range":[24963,24969]},{"id":497,"range":[25007,25014]},{"id":498,"range":[25017,25021]},{"id":499,"range":[25045,25051]},{"id":500,"range":[25209,25215]},{"id":501,"range":[25227,25231]},{"id":502,"range":[25243,25246]},{"id":503,"range":[25256,25260]},{"id":504,"range":[25266,25272]},{"id":505,"range":[25301,25307]},{"id":506,"range":[25320,25323]},{"id":507,"range":[25338,25342]},{"id":508,"range":[25380,25384]},{"id":509,"range":[25399,25405]},{"id":510,"range":[25616,25622]},{"id":511,"range":[25634,25638]},{"id":512,"range":[25640,25647]},{"id":513,"range":[25655,25661]},{"id":514,"range":[25755,25763]},{"id":515,"range":[25775,25784]},{"id":516,"range":[25792,25798]},{"id":517,"range":[25818,25824]},{"id":518,"range":[26014,26023]},{"id":519,"range":[26047,26052]},{"id":520,"range":[26070,26076]},{"id":521,"range":[26100,26104]},{"id":522,"range":[26178,26182]},{"id":523,"range":[26229,26235]},{"id":524,"range":[26339,26346]},{"id":525,"range":[26358,26363]},{"id":526,"range":[26365,26369]},{"id":527,"range":[26377,26383]},{"id":528,"range":[26430,26436]},{"id":529,"range":[26643,26649]},{"id":530,"range":[26661,26664]},{"id":531,"range":[26694,26700]},{"id":532,"range":[26725,26731]},{"id":533,"range":[26757,26761]},{"id":534,"range":[26834,26840]},{"id":535,"range":[26907,26915]},{"id":536,"range":[26927,26930]},{"id":537,"range":[26942,26946]},{"id":538,"range":[26970,26976]},{"id":539,"range":[27000,27006]},{"id":540,"range":[27073,27082]},{"id":541,"range":[27109,27115]},{"id":542,"range":[27192,27199]},{"id":543,"range":[27211,27214]},{"id":544,"range":[27226,27230]},{"id":545,"range":[27254,27260]},{"id":546,"range":[27284,27289]},{"id":547,"range":[27356,27364]},{"id":548,"range":[27402,27408]},{"id":549,"range":[27503,27511]},{"id":550,"range":[27523,27526]},{"id":551,"range":[27538,27544]},{"id":552,"range":[27559,27563]},{"id":553,"range":[27646,27666]},{"id":554,"range":[27688,27694]},{"id":555,"range":[27810,27821]},{"id":556,"range":[27824,27833]},{"id":557,"range":[27845,27848]},{"id":558,"range":[27860,27865]},{"id":559,"range":[27960,27966]},{"id":560,"range":[28064,28072]},{"id":561,"range":[28084,28087]},{"id":562,"range":[28117,28123]},{"id":563,"range":[28175,28181]},{"id":564,"range":[28226,28235]},{"id":565,"range":[28272,28278]},{"id":566,"range":[28369,28375]},{"id":567,"range":[28387,28390]},{"id":568,"range":[28392,28400]},{"id":569,"range":[28402,28409]},{"id":570,"range":[28421,28427]},{"id":571,"range":[28509,28514]},{"id":572,"range":[28580,28591]},{"id":573,"range":[28839,28845]},{"id":574,"range":[28932,28938]},{"id":575,"range":[28950,28953]},{"id":576,"range":[28955,28963]},{"id":577,"range":[28965,28972]},{"id":578,"range":[28984,28988]},{"id":579,"range":[29030,29038]},{"id":580,"range":[29230,29236]},{"id":581,"range":[29330,29340]},{"id":582,"range":[29352,29355]},{"id":583,"range":[29385,29391]},{"id":584,"range":[29443,29449]},{"id":585,"range":[29520,29529]},{"id":586,"range":[29566,29572]},{"id":587,"range":[29641,29648]},{"id":588,"range":[29660,29663]},{"id":589,"range":[29693,29699]},{"id":590,"range":[29709,29715]},{"id":591,"range":[29986,29991]},{"id":592,"range":[30003,30006]},{"id":593,"range":[30008,30019]},{"id":594,"range":[30049,30055]},{"id":595,"range":[30132,30134]},{"id":596,"range":[30146,30147]},{"id":597,"range":[30149,30150]},{"id":598,"range":[30152,30158]},{"id":599,"range":[30160,30166]},{"id":600,"range":[30357,30363]},{"id":601,"range":[30492,30498]},{"id":602,"range":[30567,30568]},{"id":603,"range":[30607,30608]},{"id":604,"range":[30665,30674]},{"id":605,"range":[30734,30740]},{"id":606,"range":[31906,31912]},{"id":607,"range":[32092,32098]},{"id":608,"range":[32284,32290]},{"id":609,"range":[32437,32442]},{"id":610,"range":[32460,32465]},{"id":611,"range":[32720,32726]},{"id":612,"range":[32851,32855]},{"id":613,"range":[32861,32867]},{"id":614,"range":[33049,33053]},{"id":615,"range":[33072,33078]},{"id":616,"range":[33942,33948]},{"id":617,"range":[34031,34040]},{"id":618,"range":[34052,34053]},{"id":619,"range":[34055,34056]},{"id":620,"range":[34064,34070]},{"id":621,"range":[34202,34211]},{"id":622,"range":[34223,34226]},{"id":623,"range":[34251,34257]},{"id":624,"range":[34329,34335]},{"id":625,"range":[34400,34406]},{"id":626,"range":[34418,34424]},{"id":627,"range":[34476,34487]},{"id":628,"range":[34499,34502]},{"id":629,"range":[34510,34516]},{"id":630,"range":[34635,34644]},{"id":631,"range":[34775,34785]},{"id":632,"range":[34797,34800]},{"id":633,"range":[34808,34814]},{"id":634,"range":[35018,35022]},{"id":635,"range":[35030,35044]},{"id":636,"range":[35056,35059]},{"id":637,"range":[35069,35075]},{"id":638,"range":[35302,35315]},{"id":639,"range":[35327,35330]},{"id":640,"range":[35340,35346]},{"id":641,"range":[35465,35477]},{"id":642,"range":[35489,35492]},{"id":643,"range":[35502,35508]},{"id":644,"range":[35590,35600]},{"id":645,"range":[35612,35615]},{"id":646,"range":[35623,35629]},{"id":647,"range":[35765,35772]},{"id":648,"range":[35784,35787]},{"id":649,"range":[35795,35801]},{"id":650,"range":[35875,35886]},{"id":651,"range":[35898,35901]},{"id":652,"range":[35909,35915]},{"id":653,"range":[36036,36044]},{"id":654,"range":[36056,36059]},{"id":655,"range":[36067,36073]},{"id":656,"range":[36132,36145]},{"id":657,"range":[36157,36160]},{"id":658,"range":[36168,36174]},{"id":659,"range":[36331,36336]},{"id":660,"range":[36348,36351]},{"id":661,"range":[36353,36356]},{"id":662,"range":[36364,36370]},{"id":663,"range":[36618,36630]},{"id":664,"range":[36650,36656]},{"id":665,"range":[36683,36689]},{"id":666,"range":[36766,36776]},{"id":667,"range":[36788,36793]},{"id":668,"range":[36801,36807]},{"id":669,"range":[36823,36833]},{"id":670,"range":[36845,36850]},{"id":671,"range":[36858,36864]},{"id":672,"range":[36884,36890]},{"id":673,"range":[36913,36919]},{"id":674,"range":[36939,36949]},{"id":675,"range":[36961,36964]},{"id":676,"range":[36972,36978]},{"id":677,"range":[36988,36991]},{"id":678,"range":[37001,37007]},{"id":679,"range":[37127,37136]},{"id":680,"range":[37148,37153]},{"id":681,"range":[37161,37167]},{"id":682,"range":[37177,37180]},{"id":683,"range":[37207,37213]},{"id":684,"range":[37257,37263]},{"id":685,"range":[37328,37334]},{"id":686,"range":[37348,37354]},{"id":687,"range":[37408,37415]},{"id":688,"range":[37427,37428]},{"id":689,"range":[37430,37438]},{"id":690,"range":[37440,37447]},{"id":691,"range":[37459,37464]},{"id":692,"range":[37522,37530]},{"id":693,"range":[37564,37570]},{"id":694,"range":[37648,37656]},{"id":695,"range":[37668,37671]},{"id":696,"range":[37673,37676]},{"id":697,"range":[37709,37712]},{"id":698,"range":[37726,37729]},{"id":699,"range":[37745,37751]},{"id":700,"range":[37884,37889]},{"id":701,"range":[37997,38006]},{"id":702,"range":[38137,38155]},{"id":703,"range":[38263,38276]},{"id":704,"range":[38566,38572]},{"id":705,"range":[38580,38589]},{"id":706,"range":[38601,38607]},{"id":707,"range":[38637,38643]},{"id":708,"range":[38654,38660]},{"id":709,"range":[38715,38720]},{"id":710,"range":[38732,38738]},{"id":711,"range":[38919,38927]},{"id":712,"range":[38939,38945]},{"id":713,"range":[38947,38955]},{"id":714,"range":[38983,38989]},{"id":715,"range":[39006,39011]},{"id":716,"range":[39036,39042]},{"id":717,"range":[39162,39169]},{"id":718,"range":[39181,39184]},{"id":719,"range":[39226,39230]},{"id":720,"range":[39244,39248]},{"id":721,"range":[39251,39258]},{"id":722,"range":[39278,39295]},{"id":723,"range":[39323,39327]},{"id":724,"range":[39392,39398]},{"id":725,"range":[39580,39589]},{"id":726,"range":[39597,39607]},{"id":727,"range":[39619,39625]},{"id":728,"range":[39637,39639]},{"id":729,"range":[39664,39670]},{"id":730,"range":[39845,39863]},{"id":731,"range":[40165,40172]},{"id":732,"range":[40285,40292]},{"id":733,"range":[40431,40438]},{"id":734,"range":[40477,40487]},{"id":735,"range":[40499,40504]},{"id":736,"range":[40512,40518]},{"id":737,"range":[40763,40773]},{"id":738,"range":[40785,40789]},{"id":739,"range":[40791,40795]},{"id":740,"range":[40797,40805]},{"id":741,"range":[40813,40821]},{"id":742,"range":[40950,40957]},{"id":743,"range":[41223,41228]},{"id":744,"range":[41242,41248]},{"id":745,"range":[41296,41301]},{"id":746,"range":[41303,41309]},{"id":747,"range":[41311,41322]},{"id":748,"range":[41324,41332]},{"id":749,"range":[41334,41340]},{"id":750,"range":[41350,41356]},{"id":751,"range":[41422,41427]},{"id":752,"range":[41482,41488]},{"id":753,"range":[41823,41829]},{"id":754,"range":[41849,41855]},{"id":755,"range":[41969,41975]},{"id":756,"range":[42020,42026]},{"id":757,"range":[42330,42336]},{"id":758,"range":[42362,42370]},{"id":759,"range":[42382,42386]},{"id":760,"range":[42396,42402]},{"id":761,"range":[42519,42527]},{"id":762,"range":[42562,42577]},{"id":763,"range":[42633,42639]},{"id":764,"range":[42723,42730]},{"id":765,"range":[42742,42745]},{"id":766,"range":[42753,42759]},{"id":767,"range":[43093,43099]},{"id":768,"range":[43111,43114]},{"id":769,"range":[43122,43128]},{"id":770,"range":[43387,43391]},{"id":771,"range":[43403,43409]},{"id":772,"range":[43434,43451]},{"id":773,"range":[43477,43480]},{"id":774,"range":[43624,43630]},{"id":775,"range":[43770,43774]},{"id":776,"range":[43786,43792]},{"id":777,"range":[43817,43834]},{"id":778,"range":[43856,43862]},{"id":779,"range":[44044,44055]},{"id":780,"range":[44070,44076]},{"id":781,"range":[44183,44189]},{"id":782,"range":[44831,44837]}]}')</script></pre>
        <script src='http://code.jquery.com/jquery-1.10.1.js'></script>

        <script>
        $(document).ready(function(){
           // Generated by gruntfile based on bookmarklet directory
var generalCss = '.annotated-element {\n    box-shadow: 0px 1px #7070ff; /* 1px outline bottom */\n    padding-bottom: 1px; /* So the box shadow isn\'t right next to underscores */\n}\n.annotated-element.no-logging-result {\n    box-shadow: 0px 1px #bbb;\n}\n.annotated-element.hover {\n    background: #eee;\n}\n\n.annotation {\n    position: absolute;\n    padding: 5px;\n    background: rgba(254, 254,254, .95);\n    color: black;\n    box-shadow: 1px 1px 4px #bbb;\n}\n.annotation .content {\n    font-family: Consolas, monospace;\n}\n.annotation .title {\n    display: block;\n    padding-bottom: 1px;\n    margin-bottom: 8px;\n    font-size: 13px;\n    font-weight: bold;\n    border-bottom: 1px solid #bbb;\n}\n\nbody.local-server {\n    margin-top: -20px;\n}\nbody.local-server .annotated-element.hover{\n    color: red;\n    background: transparent;\n}\nbody.local-server .annotation {\n    position: absolute;\n    padding: 5px;\n    background: rgba(1, 1,1, .95);\n    color: #fafafa;\n    box-shadow: 1px 1px 4px #bbb;\n}\n';
var generalJs = 'function initializeAnnotations(results){\n    function hideBubble(annotationElement){\n        if ($(annotationElement).data(\'dont-hide-annotation\')){return};\n        $(annotationElement).data(\'annotationBubble\').remove();\n        $(annotationElement).removeData(\'annotationBubble\');\n    }\n\n    function createAnnotationBubble(annotationElement){\n        var annotationBubble = $(\'<div>\')\n            .addClass(\'annotation\')\n            .hide()\n            .appendTo(\'body\');\n\n        $(annotationElement).data(\'cursorIsInsideAnnotationBubble\', false)\n        annotationBubble.on(\'mouseenter\', function(){\n            $(annotationElement).data(\'cursorIsInsideAnnotationBubble\', true)\n        })\n        annotationBubble.on(\'mouseleave\', function(){\n            $(annotationElement).data(\'cursorIsInsideAnnotationBubble\', false)\n\n            hideBubble(annotationElement)\n        })\n        return annotationBubble;\n    }\n\n    var currentAnnotationIndex;\n    $(\'.annotated-element\').on(\'mouseenter\', function(){\n        var el = this;\n        var annotationIndex = $(el).data(\'annotationIndex\');\n        showAnnotation(annotationIndex)\n    });\n\n\n    var showAnnotation = function(annotationIndex){\n        currentAnnotationIndex =annotationIndex;\n        // On the Github overlay annotations can cover\n        // multiple spans, only the first one has all the\n        var allAnnotationElements = $(\'.js-annotation-index-\' + annotationIndex);\n        el = allAnnotationElements[0];\n\n        allAnnotationElements.addClass(\'hover\');\n        var bubbleIsAlreadyShown = $(el).data(\'annotationBubble\') !== undefined\n        if (bubbleIsAlreadyShown){\n            return;\n        }\n\n        var result = results[annotationIndex]\n        if (result===undefined){\n            result = \'No annotation is available for this variable... it might not have been used during logging.\'\n        }\n\n        var content = \'\';\n        var title = \'\';\n\n        if (typeof result === \'string\'){\n            var lines = result.split(\'\\n\');\n            if (lines.length == 1){\n                content = formatAndEscapeString(result);\n            }\n            else {\n                title = lines.shift();\n                content = lines.join(\'\\n\').trim();\n            }\n        }\n        else {\n            title = \'Array[\' + result.length + \']\';\n\n            var compactView = \'[\' + result.items.join(\', \') + \']\';\n            if (compactView.length <= 20){\n                content = compactView;\n            }\n            else {\n                var multiLineView = \'[\';\n                multiLineView += result.items.join(\',\\n\');\n                multiLineView += \']\';\n                content = multiLineView;\n            }\n        }\n\n        function formatAndEscapeString(str){\n            var ret = htmlEscapeQuotes(str)\n            .replace(/\\</g, \'&lt;\')\n            .replace(/\\>/g, \'&gt;\')\n            .replace(/\\n/g, \'<br>\')\n            .replace(/ /g, \'&nbsp;\');\n            return ret;\n        }\n\n        title = formatAndEscapeString(title);\n        content = formatAndEscapeString(content);\n        var html = (title ? \'<div class=\"title\">\' + title + \'</div>\' : \'\') + \'<div class=\"content\">\' + content + \'</div>\';\n        var annotationBubble = createAnnotationBubble(el);\n        $(el).data(\'annotationBubble\', annotationBubble)\n        annotationBubble.html(html);\n\n        var top, left;\n        top = $(el).offset().top - annotationBubble.height() - 10;\n        if (top < 0){\n            top = $(el).offset().top + 20;\n        }\n        left = $(el).offset().left;\n\n        annotationBubble.css({\n            top: top,\n            left: left\n        });\n        annotationBubble.show();\n\n    }\n\n    $(\'.annotated-element\').on(\'mouseleave\', function(){\n        var el = this;\n        var annotationIndex = $(el).data(\'annotationIndex\');\n        var allAnnotationElements = $(\'.js-annotation-index-\' + annotationIndex);\n        var firstEl = allAnnotationElements[0];\n        allAnnotationElements.removeClass(\'hover\');\n        setTimeout(function(){\n            if ($(firstEl).data(\'cursorIsInsideAnnotationBubble\')){return;}\n            if (!$(firstEl).data(\'annotationBubble\')){/* already hidden */;return;}\n            hideBubble(firstEl)\n        }, 100)\n    });\n\n    $(\'.annotated-element\').dblclick(function(){\n        $(this).data(\'dont-hide-annotation\', !$(this).data(\'dont-hide-annotation\'));\n    })\n}\n\n\n\nfunction htmlEscapeQuotes(str){\n    str = str.replace(/\"/g, \'&quot;\');\n    str = str.replace(/\'/g, \'&#39;\');\n    return str;\n}\n\nfunction stripNonAsciiCharacters(str){\n    return str.replace(/[^\\nA-Za-z 0-9 \\.,\\?\"\"\\\'!@#\\$%\\^&\\*\\(\\)-_=\\+;:<>\\/\\\\\\|\\}\\{\\[\\]`~]*/g, \'\');\n}\n';

$('body').append('<style>' + generalCss + '</style>');
$('body').append('<scr' + 'ipt>' + generalJs + '</scr' + 'ipt>');

function stripFinalLineBreaks(str){
    var lines = str.split('\n');
    // Github strips out final new lines in gists, so always strip them
    var reversedLines = lines.reverse();
    for (var i=0; i< reversedLines.length;i++){
        if (reversedLines[i] == ''){
            reversedLines.shift();
            i--;
        }
        else {
            break;
        }
    }
    lines = reversedLines.reverse();
    return lines.join('\n')
}

var code = '';
var lineElements;
if ($('.code-body .line').length > 0){
    // github.com
    lineElements = $('.code-body .line')
} else if ($('.line-pre .line').length > 0){
    //gist.github.com
    lineElements = $('.line-pre .line');
}
else {
    // Normal pygments
    var lines = $('.highlight pre').html().split('\n');
    var html = ''
    $.each(lines, function(i, line){
        html += '<div class="line" style="height: 19px;">' + line + "</div>"
    });
    $('.highlight pre').html(html)
    lineElements = $('.highlight pre .line');
}

if (!window.vAnnotateResults){
    lineElements.each(function(){
        var text = $(this).text();
        // Replace non breaking spaces
        text = text.replace(/\u00A0/g, ' ');
        // Pygments puts nbsp's into empty lines, so strip them out...
        if (text == ' '){
            text = '';
        }
        code += text + '\n';
    });
    code = stripFinalLineBreaks(code)

    code = code.replace(/\n/g,'\n');
    var fileHash = sha1(stripNonAsciiCharacters(code));

    $.get('https://vannotate.s3.amazonaws.com/v1/' + fileHash + '.json', function(response){
        if (response.setup && response.setup[0]){
            displayResults(response.setup, response.results);
        }
    });
} else {
    displayResults(window.vAnnotateResults.setup, window.vAnnotateResults.results);
}

function displayResults(setup, results){
    var logItemIndex = 0;
    var pos = 0;

    lineElements.each(function(){
        $(this).contents().each(function(){
            var logItem = setup[logItemIndex];

            if (logItem && pos >= logItem.range[0] && pos <= logItem.range[1]){
                var annotationClass = 'js-annotation-index-' + logItemIndex;
                $(this).attr('data-annotation-index', logItemIndex)
                $(this).addClass(annotationClass);
                $(this).addClass('annotated-element');
                if ($('.' + annotationClass).length > 1){
                    $('.' + annotationClass).css('border-left-width', '0').css('padding-left', 0).css('padding-right', 0);
                    $('.' + annotationClass).css('border-right-width', '0').css('padding-left', 0).css('padding-right', 0);
                    $('.' + annotationClass).first().css('border-left-width', '1px').css('padding-left', 'inherit')
                    $('.' + annotationClass).last().css('border-right-width', '1px').css('padding-right', 'inherit');
                }
                $(this).attr('data-debug-start-index', pos);
                if (results[logItemIndex] === undefined){
                    $(this).addClass('no-logging-result')
                }
            }
            if (this.nodeType === 3){
                pos += this.textContent.length;
            } else {
                pos += $(this).text().length;
            }

            if (logItem && logItem.range[1] <= pos){
                logItemIndex++;
            }
        })
        pos++;
    });

    initializeAnnotations(results);
}


// https://github.com/kvz/phpjs/blob/master/functions/strings/sha1.js
/*
Copyright (c) 2013 Kevin van Zonneveld (http://kvz.io)
and Contributors (http://phpjs.org/authors)

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
of the Software, and to permit persons to whom the Software is furnished to do
so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
function sha1(str) {
  //  discuss at: http://phpjs.org/functions/sha1/
  // original by: Webtoolkit.info (http://www.webtoolkit.info/)
  // improved by: Michael White (http://getsprink.com)
  // improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  //    input by: Brett Zamir (http://brett-zamir.me)
  //   example 1: sha1('Kevin van Zonneveld');
  //   returns 1: '54916d2e62f65b3afa6e192e6a601cdbe5cb5897'

  var rotate_left = function (n, s) {
    var t4 = (n << s) | (n >>> (32 - s));
    return t4;
  };

  /*var lsb_hex = function (val) {
   // Not in use; needed?
    var str="";
    var i;
    var vh;
    var vl;

    for ( i=0; i<=6; i+=2 ) {
      vh = (val>>>(i*4+4))&0x0f;
      vl = (val>>>(i*4))&0x0f;
      str += vh.toString(16) + vl.toString(16);
    }
    return str;
  };*/

  var cvt_hex = function (val) {
    var str = '';
    var i;
    var v;

    for (i = 7; i >= 0; i--) {
      v = (val >>> (i * 4)) & 0x0f;
      str += v.toString(16);
    }
    return str;
  };

  var blockstart;
  var i, j;
  var W = new Array(80);
  var H0 = 0x67452301;
  var H1 = 0xEFCDAB89;
  var H2 = 0x98BADCFE;
  var H3 = 0x10325476;
  var H4 = 0xC3D2E1F0;
  var A, B, C, D, E;
  var temp;

  // utf8_encode
  str = unescape(encodeURIComponent(str));
  var str_len = str.length;

  var word_array = [];
  for (i = 0; i < str_len - 3; i += 4) {
    j = str.charCodeAt(i) << 24 | str.charCodeAt(i + 1) << 16 | str.charCodeAt(i + 2) << 8 | str.charCodeAt(i + 3);
    word_array.push(j);
  }

  switch (str_len % 4) {
  case 0:
    i = 0x080000000;
    break;
  case 1:
    i = str.charCodeAt(str_len - 1) << 24 | 0x0800000;
    break;
  case 2:
    i = str.charCodeAt(str_len - 2) << 24 | str.charCodeAt(str_len - 1) << 16 | 0x08000;
    break;
  case 3:
    i = str.charCodeAt(str_len - 3) << 24 | str.charCodeAt(str_len - 2) << 16 | str.charCodeAt(str_len - 1) <<
      8 | 0x80;
    break;
  }

  word_array.push(i);

  while ((word_array.length % 16) != 14) {
    word_array.push(0);
  }

  word_array.push(str_len >>> 29);
  word_array.push((str_len << 3) & 0x0ffffffff);

  for (blockstart = 0; blockstart < word_array.length; blockstart += 16) {
    for (i = 0; i < 16; i++) {
      W[i] = word_array[blockstart + i];
    }
    for (i = 16; i <= 79; i++) {
      W[i] = rotate_left(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1);
    }

    A = H0;
    B = H1;
    C = H2;
    D = H3;
    E = H4;

    for (i = 0; i <= 19; i++) {
      temp = (rotate_left(A, 5) + ((B & C) | (~B & D)) + E + W[i] + 0x5A827999) & 0x0ffffffff;
      E = D;
      D = C;
      C = rotate_left(B, 30);
      B = A;
      A = temp;
    }

    for (i = 20; i <= 39; i++) {
      temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & 0x0ffffffff;
      E = D;
      D = C;
      C = rotate_left(B, 30);
      B = A;
      A = temp;
    }

    for (i = 40; i <= 59; i++) {
      temp = (rotate_left(A, 5) + ((B & C) | (B & D) | (C & D)) + E + W[i] + 0x8F1BBCDC) & 0x0ffffffff;
      E = D;
      D = C;
      C = rotate_left(B, 30);
      B = A;
      A = temp;
    }

    for (i = 60; i <= 79; i++) {
      temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & 0x0ffffffff;
      E = D;
      D = C;
      C = rotate_left(B, 30);
      B = A;
      A = temp;
    }

    H0 = (H0 + A) & 0x0ffffffff;
    H1 = (H1 + B) & 0x0ffffffff;
    H2 = (H2 + C) & 0x0ffffffff;
    H3 = (H3 + D) & 0x0ffffffff;
    H4 = (H4 + E) & 0x0ffffffff;
  }

  temp = cvt_hex(H0) + cvt_hex(H1) + cvt_hex(H2) + cvt_hex(H3) + cvt_hex(H4);
  return temp.toLowerCase();
}

        });
        </script>
    </body>
</html>
